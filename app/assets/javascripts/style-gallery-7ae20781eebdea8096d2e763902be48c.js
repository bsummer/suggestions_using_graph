!function(){Namespace("utils");var e=!1;utils.extend({scrollBottomListener:function(){if(!e){var t=650,i=function(){return utils.device.phone()?$(".container-fluid-inner").height()-$(".container-fluid").scrollTop():$(document).height()-($(window).scrollTop()+$(window).height())},o=function(){0!=$(window).data("scrollAjaxReady")&&(i()<=t&&($(window).data("scrollAjaxReady",!1),_e.trigger("scroll:bottom")),$(window).scrollTop()>750?$(".scroll-to-top").fadeIn():$(".scroll-to-top").fadeOut())};$(".container-fluid").scroll(o),$(window).scroll(o),e=!0}}})}(),Backbone.Paginator=function(e,t,i){"use strict";var o=t.map(e.VERSION.split("."),function(e){return parseInt(e,10)}),n={};n.version="<%= pkg.version %>",n.clientPager=e.Collection.extend({useDiacriticsPlugin:!0,useLevenshteinPlugin:!0,sortColumn:"",sortDirection:"desc",lastSortColumn:"",fieldFilterRules:[],lastFieldFilterRules:[],filterFields:"",filterExpression:"",lastFilterExpression:"",defaults_ui:{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4},initialize:function(){this.on("add",this.addModel,this),this.on("remove",this.removeModel,this),this.setDefaults()},setDefaults:function(){var e=t.defaults(this.paginator_ui,this.defaults_ui);t.defaults(this,e)},addModel:function(e){this.origModels.push(e)},removeModel:function(e){var i=t.indexOf(this.origModels,e);this.origModels.splice(i,1)},sync:function(n,a,s){var r=this;this.setDefaults();var l={};t.each(t.result(r,"server_api"),function(e,i){t.isFunction(e)&&(e=t.bind(e,r),e=e()),l[i]=e});var c=t.clone(r.paginator_core);t.each(c,function(e,i){t.isFunction(e)&&(e=t.bind(e,r),e=e()),c[i]=e}),c=t.defaults(c,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),c=t.extend(c,{data:decodeURIComponent(i.param(l)),processData:!1,url:t.result(c,"url")},s);var d=!(0===o[0]&&9===o[1]&&10===o[2]),u=0===o[0],h=c.success;c.success=function(e,t,i){h&&(d?h(e,t,i):h(a,e,c)),u&&a&&a.trigger&&a.trigger("sync",a,e,c)};var g=c.error;c.error=function(e){g&&g(a,e,c),u&&a&&a.trigger&&a.trigger("error",a,e,c)};var p=c.xhr=e.ajax(c);return a&&a.trigger&&a.trigger("request",a,p,c),p},nextPage:function(e){this.currentPage<this.information.totalPages&&(this.currentPage=++this.currentPage,this.pager(e))},previousPage:function(e){this.currentPage>1&&(this.currentPage=--this.currentPage,this.pager(e))},goTo:function(e,t){void 0!==e&&(this.currentPage=parseInt(e,10),this.pager(t))},howManyPer:function(e){if(void 0!==e){var t=this.perPage;this.perPage=parseInt(e,10),this.currentPage=Math.ceil((t*(this.currentPage-1)+1)/e),this.pager()}},setSort:function(e,t){void 0!==e&&void 0!==t&&(this.lastSortColumn=this.sortColumn,this.sortColumn=e,this.sortDirection=t,this.pager(),this.info())},setFieldFilter:function(e){t.isEmpty(e)?(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules="",this.pager(),this.info()):(this.lastFieldFilterRules=this.fieldFilterRules,this.fieldFilterRules=e,this.pager(),this.info())},doFakeFieldFilter:function(e){if(!t.isEmpty(e)){var i=this.origModels;return void 0===i&&(i=this.models),i=this._fieldFilter(i,e),""!==this.filterExpression&&(i=this._filter(i,this.filterFields,this.filterExpression)),i.length}},setFilter:function(e,t){void 0!==e&&void 0!==t&&(this.filterFields=e,this.lastFilterExpression=this.filterExpression,this.filterExpression=t,this.pager(),this.info())},doFakeFilter:function(e,i){if(void 0!==e&&void 0!==i){var o=this.origModels;return void 0===o&&(o=this.models),t.isEmpty(this.fieldFilterRules)||(o=this._fieldFilter(o,this.fieldFilterRules)),o=this._filter(o,e,i),o.length}},pager:function(e){var i=this,o=this.perPage,n=(i.currentPage-1)*o,a=n+o;void 0===i.origModels&&(i.origModels=i.models),i.models=i.origModels.slice(),""!==this.sortColumn&&(i.models=i._sort(i.models,this.sortColumn,this.sortDirection)),t.isEmpty(this.fieldFilterRules)||(i.models=i._fieldFilter(i.models,this.fieldFilterRules)),""!==this.filterExpression&&(i.models=i._filter(i.models,this.filterFields,this.filterExpression)),this.lastSortColumn===this.sortColumn&&this.lastFilterExpression===this.filterExpression&&t.isEqual(this.fieldFilterRules,this.lastFieldFilterRules)||(n=0,a=n+o,i.currentPage=1,this.lastSortColumn=this.sortColumn,this.lastFieldFilterRules=this.fieldFilterRules,this.lastFilterExpression=this.filterExpression),i.sortedAndFilteredModels=i.models.slice(),i.info(),i.reset(i.models.slice(n,a)),t.result(e,"success")},_sort:function(e,i,o){return e=e.sort(function(e,n){var a=e.get(i),s=n.get(i);if(t.isUndefined(a)||t.isUndefined(s)||null===a||null===s)return 0;if(a=a.toString().toLowerCase(),s=s.toString().toLowerCase(),"desc"===o)if(!a.match(/[^\-\d\.]/)&&a.match(/-?[\d\.]+/)&&!s.match(/[^\-\d\.]/)&&s.match(/-?[\d\.]+/)){if(s-0>a-0)return 1;if(a-0>s-0)return-1}else{if(s>a)return 1;if(a>s)return-1}else if(!a.match(/[^\-\d\.]/)&&a.match(/-?[\d\.]+/)&&!s.match(/[^\-\d\.]/)&&s.match(/-?[\d\.]+/)){if(s-0>a-0)return-1;if(a-0>s-0)return 1}else{if(s>a)return-1;if(a>s)return 1}if(e.cid&&n.cid){var r=e.cid,l=n.cid;if(l>r)return-1;if(r>l)return 1}return 0})},_fieldFilter:function(e,i){if(t.isEmpty(i))return e;var o=[];return t.each(e,function(e){var n=!0;t.each(i,function(i){if(!n)return!1;if(n=!1,"function"===i.type){var o=t.wrap(i.value,function(t){return t(e.get(i.field))});o()&&(n=!0)}else"required"===i.type?t.isEmpty(e.get(i.field).toString())||(n=!0):"min"===i.type?!t.isNaN(Number(e.get(i.field)))&&!t.isNaN(Number(i.value))&&Number(e.get(i.field))>=Number(i.value)&&(n=!0):"max"===i.type?!t.isNaN(Number(e.get(i.field)))&&!t.isNaN(Number(i.value))&&Number(e.get(i.field))<=Number(i.value)&&(n=!0):"range"===i.type?!t.isNaN(Number(e.get(i.field)))&&t.isObject(i.value)&&!t.isNaN(Number(i.value.min))&&!t.isNaN(Number(i.value.max))&&Number(e.get(i.field))>=Number(i.value.min)&&Number(e.get(i.field))<=Number(i.value.max)&&(n=!0):"minLength"===i.type?e.get(i.field).toString().length>=i.value&&(n=!0):"maxLength"===i.type?e.get(i.field).toString().length<=i.value&&(n=!0):"rangeLength"===i.type?t.isObject(i.value)&&!t.isNaN(Number(i.value.min))&&!t.isNaN(Number(i.value.max))&&e.get(i.field).toString().length>=i.value.min&&e.get(i.field).toString().length<=i.value.max&&(n=!0):"oneOf"===i.type?t.isArray(i.value)&&t.include(i.value,e.get(i.field))&&(n=!0):"equalTo"===i.type?i.value===e.get(i.field)&&(n=!0):"containsAllOf"===i.type?t.isArray(i.value)&&t.isArray(e.get(i.field))&&t.intersection(i.value,e.get(i.field)).length===i.value.length&&(n=!0):"pattern"===i.type?e.get(i.field).toString().match(i.value)&&(n=!0):n=!1}),n&&o.push(e)}),o},_filter:function(i,o,n){var a=this,s={};if(t.isString(o)?s[o]={cmp_method:"regexp"}:t.isArray(o)?t.each(o,function(e){s[e]={cmp_method:"regexp"}}):t.each(o,function(e,i){s[i]=t.defaults(e,{cmp_method:"regexp"})}),o=s,t.has(e.Paginator,"removeDiacritics")&&a.useDiacriticsPlugin&&(n=e.Paginator.removeDiacritics(n)),""===n||!t.isString(n))return i;var r=t.map(n.match(/\w+/gi),function(e){return e.toLowerCase()}),l="("+t.uniq(r).join("|")+")",c=new RegExp(l,"igm"),d=[];return t.each(i,function(i){var s=[];t.each(o,function(o,l){var d=i.get(l);if(d){var u=[];if(d=t.has(e.Paginator,"removeDiacritics")&&a.useDiacriticsPlugin?e.Paginator.removeDiacritics(d.toString()):d.toString(),"levenshtein"===o.cmp_method&&t.has(e.Paginator,"levenshtein")&&a.useLevenshteinPlugin){var h=e.Paginator.levenshtein(d,n);t.defaults(o,{max_distance:0}),h<=o.max_distance&&(u=t.uniq(r))}else u=d.match(c);u=t.map(u,function(e){return e.toString().toLowerCase()}),t.each(u,function(e){s.push(e)})}}),s=t.uniq(t.without(s,"")),t.isEmpty(t.difference(r,s))&&d.push(i)}),d},info:function(){var e=this,t={},i=e.sortedAndFilteredModels?e.sortedAndFilteredModels.length:e.length,o=Math.ceil(i/e.perPage);return t={totalUnfilteredRecords:e.origModels.length,totalRecords:i,currentPage:e.currentPage,perPage:this.perPage,totalPages:o,lastPage:o,previous:!1,next:!1,startRecord:0===i?0:(e.currentPage-1)*this.perPage+1,endRecord:Math.min(i,e.currentPage*this.perPage)},e.currentPage>1&&(t.previous=e.currentPage-1),e.currentPage<t.totalPages&&(t.next=e.currentPage+1),t.pageSet=e.setPagination(t),e.information=t,t},setPagination:function(e){var t=[],i=0,o=0,n=2*this.pagesInRange,a=Math.ceil(e.totalRecords/e.perPage);if(a>1)if(1+n>=a)for(i=1,o=a;o>=i;i++)t.push(i);else if(e.currentPage<=this.pagesInRange+1)for(i=1,o=2+n;o>i;i++)t.push(i);else if(a-this.pagesInRange>e.currentPage&&e.currentPage>this.pagesInRange)for(i=e.currentPage-this.pagesInRange;i<=e.currentPage+this.pagesInRange;i++)t.push(i);else for(i=a-n;a>=i;i++)t.push(i);return t},bootstrap:function(e){return t.extend(this,e),this.goTo(1),this.info(),this}}),n.clientPager.prototype.prevPage=n.clientPager.prototype.previousPage;var a=function(){var e=new i.Deferred;return e.reject(),e.promise()};return n.requestPager=e.Collection.extend({sync:function(n,a,s){var r=this;r.setDefaults();var l={};t.each(t.result(r,"server_api"),function(e,i){t.isFunction(e)&&(e=t.bind(e,r),e=e()),l[i]=e});var c=t.clone(r.paginator_core);t.each(c,function(e,i){t.isFunction(e)&&(e=t.bind(e,r),e=e()),c[i]=e}),c=t.defaults(c,{timeout:25e3,cache:!1,type:"GET",dataType:"jsonp"}),s.data=s.data?decodeURIComponent(i.param(t.extend(l,s.data))):decodeURIComponent(i.param(l)),c=t.extend(c,{data:decodeURIComponent(i.param(l)),processData:!1,url:t.result(c,"url")},s);var d=!(0===o[0]&&9===o[1]&&10===o[2]),u=0===o[0],h=c.success;c.success=function(e,t,i){h&&(d?h(e,t,i):h(a,e,c)),u&&a&&a.trigger&&a.trigger("sync",a,e,c)};var g=c.error;c.error=function(e){g&&g(e),u&&a&&a.trigger&&a.trigger("error",a,e,c)};var p=c.xhr=e.ajax(c);return a&&a.trigger&&a.trigger("request",a,p,c),p},setDefaults:function(){var e=this;t.defaults(e.paginator_ui,{firstPage:0,currentPage:1,perPage:5,totalPages:10,pagesInRange:4}),t.each(e.paginator_ui,function(i,o){t.isUndefined(e[o])&&(e[o]=e.paginator_ui[o])})},requestNextPage:function(e){return void 0!==this.currentPage?(this.currentPage+=1,this.pager(e)):a()},requestPreviousPage:function(e){return void 0!==this.currentPage?(this.currentPage-=1,this.pager(e)):a()},updateOrder:function(e,t){return void 0!==e?(this.sortField=e,this.pager(t)):a()},goTo:function(e,t){return void 0!==e?(this.currentPage=parseInt(e,10),this.pager(t)):a()},howManyPer:function(e,t){return void 0!==e?(this.currentPage=this.firstPage,this.perPage=e,this.pager(t)):a()},info:function(){var e={totalRecords:this.totalRecords||0,currentPage:this.currentPage,firstPage:this.firstPage,totalPages:Math.ceil(this.totalRecords/this.perPage),lastPage:this.totalPages,perPage:this.perPage,previous:!1,next:!1};return this.currentPage>1&&(e.previous=this.currentPage-1),this.currentPage<e.totalPages&&(e.next=this.currentPage+1),e.hasNext=e.next,e.hasPrevious=e.next,e.pageSet=this.setPagination(e),this.information=e,e},setPagination:function(e){var t=[],i=0,o=0,n=2*this.pagesInRange,a=Math.ceil(e.totalRecords/e.perPage);if(a>1)if(1+n>=a)for(i=1,o=a;o>=i;i++)t.push(i);else if(e.currentPage<=this.pagesInRange+1)for(i=1,o=2+n;o>i;i++)t.push(i);else if(a-this.pagesInRange>e.currentPage&&e.currentPage>this.pagesInRange)for(i=e.currentPage-this.pagesInRange;i<=e.currentPage+this.pagesInRange;i++)t.push(i);else for(i=a-n;a>=i;i++)t.push(i);return t},pager:function(e){return t.isObject(e)||(e={}),this.fetch(e)},url:function(){return void 0!==this.paginator_core&&void 0!==this.paginator_core.url?this.paginator_core.url:null},bootstrap:function(e){return t.extend(this,e),this.setDefaults(),this.info(),this}}),n.requestPager.prototype.nextPage=n.requestPager.prototype.requestNextPage,n.requestPager.prototype.prevPage=n.requestPager.prototype.requestPreviousPage,n}(Backbone,_,jQuery),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["shared/loading_message"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<p class="spindicator">'),o.b("\n"+i),o.b('  <img src="/style-gallery/assets/spindicator-loader.gif" />'),o.b("\n"+i),o.b("  Loading&hellip;"),o.b("\n"+i),o.b("</p>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["shared/photo_guidelines"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<header class="header">'),o.b("\n"+i),o.b('  <div class="toggle-icon">+</div>'),o.b("\n"+i),o.b("  <h5>Photo Guidelines</h5>"),o.b("\n"+i),o.b("</header>"),o.b("\n"+i),o.b('<div class="photo-guidelines-body content">'),o.b("\n"+i),o.b('  <div class="controls">'),o.b("\n"+i),o.b('    <a class="arrow left-arrow" href="#" data-carousel-slide="prev"></a>'),o.b("\n"+i),o.b('    <a class="arrow right-arrow" href="#" data-carousel-slide="next"></a>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("  <ul></ul>"),o.b("\n"+i),o.b('  <div class="row">'),o.b("\n"+i),o.b("    <a class=\"view-full\" href='http://www.modcloth.com/help/community_guidelines#photo-submission'"),o.b("\n"+i),o.b('      target="_blank">View Full Guidelines</a>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/banner_layout"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="inner-banner">'),o.b("\n"+i),o.b('  <div class="title-button"></div>'),o.b("\n"+i),o.b('  <div id="title-text">'),o.b("\n"+i),o.b('    <div class="title"></div>'),o.b("\n"+i),o.b('    <div class="subtitle"></div>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b('  <div class="relationships"></div>'),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/follow_bar"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="header">'),o.b("\n"+i),o.b('  <div class="float-container">'),o.b("\n"+i),o.b('    <span class="glyph small-glyph">&#xe006;</span>'),o.b("\n"+i),o.b('    <span class="header-text">Follow</span>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/love_button"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="love-it-button">'),o.b("\n"+i),o.b('  <div class="extra-love">'),o.b("\n"+i),o.b('    <div class="first-heart heart">'),o.b("\n"+i),o.b('      <img alt="Heart1" src="/style-gallery/assets/heart1.png">'),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="second-heart heart">'),o.b("\n"+i),o.b('      <img alt="Heart2" src="/style-gallery/assets/heart2.png">'),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('      <div class="love-button  '),o.b(o.v(o.f("state",e,t,0))),o.b('">'),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="loves-count">'),o.b("\n"+i),o.b("    "),o.b(o.v(o.f("count",e,t,0))),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/outfit"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<a class="gallery-overlay-trigger" data-id="'),o.b(o.v(o.f("id",e,t,0))),o.b('" href="#">'),o.b("\n"+i),o.b('  <span class="border-box outfit-image">'),o.b("\n"+i),o.b('      <span class="corner tl"></span><span class="corner tr"></span><span class="corner bl"></span><span class="corner br"></span>'),o.b("\n"+i),o.b("  </span>"),o.b("\n"+i),o.b('  <div class="shopthelook-ribbon"></div>'),o.b("\n"+i),o.b('  <span class="center-circle"><div class="circle"></div><div class="magnifying-glass"></div></span>'),o.b("\n"+i),o.b('  <img class="outfit-image" alt="Open Outfit Link '),o.b(o.v(o.f("id",e,t,0))),o.b('" src="'),o.b(o.v(o.d("image.medium.url",e,t,0))),o.b('"'),o.b("\n"+i),o.b('    style="width: '),o.b(o.v(o.d("image.medium.width",e,t,0))),o.b("px; height: "),o.b(o.v(o.d("image.medium.height",e,t,0))),o.b('px;" />'),o.b("\n"+i),o.b('  <span class="share-widget-container"></span>'),o.b("\n"+i),o.b("</a>"),o.b("\n"+i),o.b('<div class="meta-bar">'),o.b("\n"+i),o.b('  <div class="left">'),o.b("\n"+i),o.b("    <a href='/style-gallery/users/"),o.b(o.v(o.d("contributor.id",e,t,0))),o.b('\' class="name">'),o.b(o.v(o.d("contributor.name",e,t,0))),o.b("</a>"),o.b("\n"+i),o.b('    <p class="upload-timestamp">'),o.b(o.v(o.f("moderatedAtTimeAgo",e,t,0))),o.b("</p>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b('  <div class="right">'),o.b("\n"+i),o.b('    <div class="bb-love-button gallery-view"></div>'),o.b("\n"+i),o.b('    <div class="touch-share-trigger"></div>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/outfit_detail"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="main-image">'),o.b("\n"+i),o.b('  <div class="main-image-container">'),o.b("\n"+i),o.b('    <img src="'),o.b(o.v(o.d("attributes.images.large.url",e,t,0))),o.b('" />'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.b("\n"+i),o.b('<div class="details">'),o.b("\n"+i),o.b('  <button type="button" class="close" data-dismiss="modal" value="x"></button>'),o.b("\n"+i),o.b("  "),o.b("\n"+i),o.b('  <div class="user-details">'),o.b("\n"),o.b("\n"+i),o.b('    <h3 class="uploader-name">'),o.b("\n"+i),o.b("      <a href='/style-gallery/users/"),o.b(o.v(o.d("attributes.contributor.id",e,t,0))),o.b("'>"),o.b(o.v(o.d("attributes.contributor.name",e,t,0))),o.b("</a>"),o.b("\n"+i),o.b("    </h3>"),o.b("\n"),o.b("\n"+i),o.s(o.f("user_personal_website",e,t,1),e,t,0,444,645,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('      <h4 class="uploader-extra-info">'),o.b("\n"+i),o.b('        <a href="http://'),o.b(o.v(o.d("attributes.contributor.personal_website_url",e,t,0))),o.b('" target="_blank">'),o.b(o.v(o.d("attributes.contributor.personal_website_url",e,t,0))),o.b("</a>"),o.b("\n"+i),o.b("      </h4>"),o.b("\n"+i)}),e.pop()),o.b('    <p class="date-added">Added '),o.b(o.v(o.f("moderatedAtTimeAgo",e,t,0))),o.b(" </p>"),o.b("\n"+i),o.b("    "),o.b("\n"+i),o.b('    <div class="widgets widgets-detail ">'),o.b("\n"+i),o.b('      <div class="bb-love-button love-expanded"></div>'),o.b("\n"+i),o.b('      <span class="share-widget"></span>'),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/phone/outfit_detail"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="outfit-image-container">'),o.b("\n"+i),o.b('  <ul class="detail-header">'),o.b("\n"+i),o.b('    <li><a href="#" id="back-btn"><div class="transparent-bg"></div><span>&#57346;</span></a></li>'),o.b("\n"+i),o.b('    <li class="bb-love-button detail-view"></li>'),o.b("\n"+i),o.b('    <li class="share-widget"><div class="transparent-bg"></div></li>'),o.b("\n"+i),o.b("  </ul>"),o.b("\n"),o.b("\n"+i),o.b('  <div class="main-image">'),o.b("\n"+i),o.b('    <img src="'),o.b(o.v(o.d("attributes.images.large.url",e,t,0))),o.b('" />'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"+i),o.b('<div class="user-details">'),o.b("\n"+i),o.b('  <p class="date-added">Added '),o.b(o.v(o.f("moderatedAtTimeAgo",e,t,0))),o.b("</p>"),o.b("\n"),o.b("\n"+i),o.b('  <h3 class="uploader-name">'),o.b("\n"+i),o.b("    <a href='/style-gallery/users/"),o.b(o.v(o.d("attributes.contributor.id",e,t,0))),o.b("'>"),o.b(o.v(o.d("attributes.contributor.name",e,t,0))),o.b("</a>"),o.b("\n"+i),o.b("  </h3>"),o.b("\n"),o.b("\n"+i),o.b('  <h4 class="uploader-extra-info">'),o.b("\n"+i),o.s(o.f("user_personal_website",e,t,1),e,t,0,682,778,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('      <a href="http://'),o.b(o.v(o.f("url",e,t,0))),o.b('" target="_blank">'),o.b(o.v(o.d("attributes.personal_website_url",e,t,0))),o.b("</a>"),o.b("\n"+i)}),e.pop()),o.b("  </h4>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/product"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b("\n"+i),o.b('<a href="'),o.b(o.v(o.d("_links.html",e,t,0))),o.b('" id="open-product-'),o.b(o.v(o.f("id",e,t,0))),o.b("\" data-analytics-click-event='user clicked product' data-analytics-context='productId: "),o.b(o.v(o.f("id",e,t,0))),o.b(', productName: "'),o.b(o.v(o.f("name",e,t,0))),o.b('"\' target="'),o.b(o.v(o.f("clickTarget",e,t,0))),o.b('">'),o.b("\n"+i),o.b('  <div class="product-image-container">'),o.b("\n"+i),o.b('    <img src="'),o.b(o.v(o.d("images.small.url",e,t,0))),o.b('" name="Catalog Product '),o.b(o.v(o.f("id",e,t,0))),o.b('"/>'),o.b("\n"+i),o.s(o.f("picturedItem",e,t,1),e,t,0,529,582,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('      <h3 class="pictured-ribbon">Pictured</h3>'),o.b("\n"+i)}),e.pop()),o.s(o.f("picturedItem",e,t,1),e,t,1,0,0,"")||(o.b('      <h3 class="inspired-ribbon">Similar</h3>'),o.b("\n"+i)),o.b("  </div>"),o.b("\n"+i),o.b('  <p class="name"><strong>'),o.b(o.v(o.f("name",e,t,0))),o.b("</strong></p>"),o.b("\n"+i),o.b('  <div class="price-availability">'),o.b("\n"+i),o.s(o.f("price",e,t,1),e,t,0,799,1253,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('      <div class="product-price-container">'),o.b("\n"+i),o.s(o.f("archived",e,t,1),e,t,1,0,0,"")||o.s(o.f("out_of_stock",e,t,1),e,t,1,0,0,"")||(o.s(o.f("on_sale",e,t,1),e,t,0,918,1068,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('                <span class="price list-price">'),o.b(o.v(o.f("price",e,t,0))),o.b("</span>"),o.b("\n"+i),o.b('                <span class="price sale-price">'),o.b(o.v(o.f("sale_price",e,t,0))),o.b("</span>"),o.b("\n"+i)}),e.pop()),o.s(o.f("on_sale",e,t,1),e,t,1,0,0,"")||(o.b('                <span class="price">'),o.b(o.v(o.f("price",e,t,0))),o.b("</span>"),o.b("\n"+i))),o.b("      </div>"),o.b("\n"+i)}),e.pop()),o.b('    <div class="product-availability-container">'),o.b("\n"+i),o.s(o.f("archived",e,t,1),e,t,1,0,0,"")||(o.s(o.f("scarce_on_hand",e,t,1),e,t,0,1360,1513,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.s(o.f("out_of_stock",e,t,1),e,t,1,0,0,"")||(o.b('                <span class="availability scarce">'),o.b(o.v(o.f("scarce_on_hand",e,t,0))),o.b(" LEFT!</span>"),o.b("\n"+i))}),e.pop()),o.s(o.f("out_of_stock",e,t,1),e,t,0,1558,1694,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('            <span class="availability out-of-stock">OUT OF STOCK</span>'),o.b("\n"+i),o.b('            <span class="need-it-cta">I Need It!<span>'),o.b("\n"+i)}),e.pop())),o.s(o.f("archived",e,t,1),e,t,0,1751,1826,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('        <span class="no-longer-available">NO LONGER AVAILABLE<span>'),o.b("\n"+i)}),e.pop()),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</a>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/shop_the_look"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="shop-the-look-inner">'),o.b("\n"+i),o.b('  <h3 class="title">Shop the Look</h3>'),o.b("\n"+i),o.s(o.f("displayViewSwitcher",e,t,1),e,t,0,99,439,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('    <ul id="view-switcher">'),o.b("\n"+i),o.b("      <li>View</li>"),o.b("\n"+i),o.b("      <li>"),o.b("\n"+i),o.b('        <a href="#" data-view-type="grid" class="grid-toggle"><img src="/style-gallery/assets/grid-icon.png" /></a>'),o.b("\n"+i),o.b("      </li>"),o.b("\n"+i),o.b("      <li>"),o.b("\n"+i),o.b('        <a href="#"  data-view-type="list" class="grid-toggle"><img src="/style-gallery/assets/list-icon.png" /></a>'),o.b("\n"+i),o.b("      </li>"),o.b("\n"+i),o.b("    </ul>"),o.b("\n"+i)}),e.pop()),o.b("\n"+i),o.b('  <div class="product-list carousel slide clearfix" data-interval="false">'),o.b("\n"+i),o.b('    <div class="carousel-inner"></div>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"+i),o.s(o.f("displayNavigation",e,t,1),e,t,0,617,825,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b("  <div class='navigation carousel-controls'>"),o.b("\n"+i),o.b('    <a class="arrow left-arrow" href=".product-list" data-slide="prev"></a>'),o.b("\n"+i),o.b('    <a class="arrow right-arrow" href=".product-list" data-slide="next"></a>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i)}),e.pop()),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/sliver"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="toggle-icon" id="sliver-toggle-icon">&#8211;</div>'),o.b("\n"+i),o.b('<div class="header" id="sliver-header"></div>'),o.b("\n"+i),o.b('<div class="content" id="sliver-content"></div>'),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/subtitle"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b(o.t(o.f("subtitle",e,t,0))),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/tag"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<a href="'),o.b(o.v(o.f("url",e,t,0))),o.b('">'),o.b("\n"+i),o.s(o.f("colorTag",e,t,1),e,t,0,34,72,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('  <div class="'),o.b(o.v(o.f("colorTag",e,t,0))),o.b('"></div>'),o.b("\n"+i)}),e.pop()),o.b("  "),o.b(o.v(o.f("name",e,t,0))),o.b("\n"+i),o.b("</a>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/title_banner"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b("Style Gallery"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/title_button"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<span class="'),o.b(o.v(o.f("iconClass",e,t,0))),o.b('"></span>'),o.b(o.v(o.f("label",e,t,0))),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/upload_bar"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="header">'),o.b("\n"+i),o.b('  <h4 class="header-text">Add Your Photo</h4>'),o.b("\n"+i),o.b("</div>"),o.b("\n"+i),o.b('<div class="toggle-icon glyph" id="upload-bar-toggle-icon">&#xe006</div>'),o.b("\n"+i),o.b('<div id="upload-bar-content" class="content">'),o.b("\n"+i),o.b('  <div class="inner">'),o.b("\n"+i),o.b('    <button class="mc-button jumbo-btn instagram-button" data-button-text="Add from Instagram">'),o.b("\n"+i),o.b("      <span>Add from Instagram</span>"),o.b("\n"+i),o.b("    </button>"),o.b("\n"),o.b("\n"+i),o.b('    <form accept-charset="UTF-8" action="'),o.b(o.v(o.f("formAction",e,t,0))),o.b('"'),o.b("\n"+i),o.b('      class="submit-photo-form" enctype="multipart/form-data" method="post" id="mobile-fileupload">'),o.b("\n"+i),o.b("      <div class='form-extras' style=\"margin:0;padding:0;display:inline\">"),o.b("\n"+i),o.b('        <input name="utf8" type="hidden" value="✓">'),o.b("\n"+i),o.b("      </div>"),o.b("\n"+i),o.b('      <button class="upload fileinput-button mc-button jumbo-btn '),o.b(o.v(o.f("hasUserClass",e,t,0))),o.b(' phone-button" data-button-text="Add from Your Device">'),o.b("\n"+i),o.b("        <span>Add from Your Device</span>"),o.b("\n"+i),o.b('        <input id="mobile_outfit_image" name="outfit[image_attributes][media]" type="file">'),o.b("\n"+i),o.b("      </button>"),o.b("\n"+i),o.b("    </form>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b('  <div class="errors"></div>'),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["gallery/upload_bar_errors"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b("<ul>"),o.b("\n"+i),o.s(o.f("errors",e,t,1),e,t,0,18,66,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b("  <li><strong>"),o.b(o.v(o.f("prefix",e,t,0))),o.b("</strong> "),o.b(o.v(o.d(".",e,t,0))),o.b("</li>"),o.b("\n"+i)}),e.pop()),o.b("</ul>"),o.b("\n"+i),o.b('<a href="#" class="close">&#57352;</a>'),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/bail_upload"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="exit-confirmation-header">'),o.b("\n"+i),o.b('  <a href="#" class="go-back-btn no-btn intercept-link" data-wizard-intercept-go-back="true">&laquo; Continue editing</a>'),o.b("\n"+i),o.b('  <a href="#" class="close-btn intercept-link" data-wizard-intercept-go-back="true"></a>'),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.b("\n"+i),o.b("<h2>Wanna submit this photo before you leave?</h2>"),o.b("\n"+i),o.b("<p>We'll save your place if you'd rather continue later.</p>"),o.b("\n"),o.b("\n"+i),o.b('<div class="exit-confirmation-buttons">'),o.b("\n"+i),o.b('  <a href="#" class="mc-button save-it-button intercept-link" data-wizard-intercept-abort="true"><span>No</span>, Save For Later</a>'),o.b("\n"+i),o.b('  <a href="#" class="mc-button submit-it-button intercept-link" data-wizard-intercept-finish="true"><span>Yes</span>, Submit My Photo</a>'),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/base"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="base"></div>'),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/catalog_product"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b("<a href='#' class='assign-product-link' >"),o.b("\n"+i),o.b("  <img src='"),o.b(o.v(o.f("image",e,t,0))),o.b("' alt='Catalog Product "),o.b(o.v(o.f("id",e,t,0))),o.b("'/>"),o.b("\n"+i),o.b("</a>"),o.b("\n"+i),o.s(o.f("archived",e,t,1),e,t,0,118,152,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b("  <p>No longer</br>available</p>"),o.b("\n"+i)}),e.pop()),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/choose_file"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div id="upload-header-container">'),o.b("\n"+i),o.b('  <div id="upload-header-container">'),o.b("\n"+i),o.b('  <div class="modal-header header-steps">'),o.b("\n"+i),o.b('    <div class="steps">'),o.b("\n"+i),o.b('      <ul class="upload-photo-steps">'),o.b("\n"+i),o.b('        <li class="add-photo active">'),o.b("\n"+i),o.b("          <p>Add Your Photo</p>"),o.b("\n"+i),o.b("        </li>"),o.b("\n"+i),o.b('        <li class="recreate-the-look">'),o.b("\n"+i),o.b("          <p>Recreate the Look</p>"),o.b("\n"+i),o.b("        </li>"),o.b("\n"+i),o.b("      </ul>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="close-icon">'),o.b("\n"+i),o.b('      <button class="close" data-wizard-previous="true" value="close"></button>'),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.b("\n"+i),o.b('<div class="upload-photo-container clearfix">'),o.b("\n"),o.b("\n"+i),o.b('  <div class="submit-photo-left-container">'),o.b("\n"+i),o.b('    <div class="submit-photo-container">'),o.b("\n"+i),o.b('      <p class="submit-photo-title">Choose Your Photo</p>'),o.b("\n"),o.b("\n"+i),o.s(o.f("showErrors",e,t,1),e,t,0,727,1007,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('        <h3 class="error-title">Uh oh!  There were some problems with your photo.</h3>       '),o.b("\n"+i),o.b('        <div class="outfit-upload-errors">'),o.b("\n"+i),o.b('          <ul class="errors">'),o.b("\n"+i),o.s(o.f("errors",e,t,1),e,t,0,918,958,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b("            <li>"),o.b(o.v(o.d(".",e,t,0))),o.b("</li>"),o.b("\n"+i)}),e.pop()),o.b("          </ul>"),o.b("\n"+i),o.b("        </div>"),o.b("\n"+i)}),e.pop()),o.b("      "),o.b("\n"+i),o.b('      <form accept-charset="UTF-8" action="'),o.b(o.v(o.f("formAction",e,t,0))),o.b('" class="submit-photo-form" enctype="multipart/form-data" method="post" id="fileupload">'),o.b("\n"+i),o.b('        <div class=\'form-extras\' style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="close_path" type="hidden" value="'),o.b(o.v(o.f("onClosePath",e,t,0))),o.b('"></div>'),o.b("\n"+i),o.s(o.f("loading",e,t,1),e,t,0,1388,1561,"{{ }}")&&(o.rs(e,t,function(e,t,o){o.b('        <div class="upload-loading mc-button jumbo-btn">'),o.b("\n"+i),o.b('          <img src="/style-gallery/assets/loader.gif" alt="" />'),o.b("\n"+i),o.b("          <p>LOADING...</p>"),o.b("\n"+i),o.b("        </div>"),o.b("\n"+i)
}),e.pop()),o.b("\n"+i),o.s(o.f("loading",e,t,1),e,t,1,0,0,"")||(o.b('        <span class="mc-button jumbo-btn fileinput-button">'),o.b("\n"+i),o.b('          <span class="fileupload-new">Upload from My Computer</span>'),o.b("\n"+i),o.b('          <input id="outfit_outfit_image" name="outfit[image_attributes][media]" type="file">'),o.b("\n"+i),o.b("        </span>"),o.b("\n"+i)),o.b('        <p class="file-format">JPG or PNG</p>'),o.b("\n"+i),o.b("      </form>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"),o.b("\n"+i),o.b('    <div class="photo-guidelines">'),o.b("\n"+i),o.b('      <a class="full-guidelines-link" href="http://www.modcloth.com/help/community_guidelines#photo-submission" target="_blank">View Full Guidelines</a>'),o.b("\n"),o.b("\n"+i),o.b('      <p class="submit-photo-title">Photo Guidelines</p>'),o.b("\n"),o.b("\n"+i),o.b('      <ul class="guidelines-list">'),o.b("\n"+i),o.b("        <li>We love head-to-toe shots because they show us the outstanding outfits you put together.</li>"),o.b("\n"+i),o.b("        <li>We can’t accept any long distance, crowd, or overly blurry photos.</li>"),o.b("\n"+i),o.b("        <li>Photos need to be at least 462 px wide.</li>"),o.b("\n"+i),o.b("        <li>We moderate all user-submitted photos and captions, so please keep in mind our"),o.b("\n"+i),o.b("          <a href='http://www.modcloth.com/help/community_guidelines#photo-submission' target=\"_blank\">guidelines</a>"),o.b("\n"+i),o.b("          and <a href='http://www.modcloth.com/help/terms-of-use' target=\"_blank\">Terms of Use</a>."),o.b("\n"+i),o.b("        </li>"),o.b("\n"+i),o.b("        <li>Don’t forget to tell your friends and family to share your shots on their social networks!</li>"),o.b("\n"+i),o.b("      </ul>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.b("\n"+i),o.b('  <div class="submit-photo-right-container">'),o.b("\n"+i),o.b("    <h4>Photo Tips from Our ModStylists</h4>"),o.b("\n"+i),o.b('    <iframe width="372" height="209" src="http://www.youtube.com/embed/xDKdtXYoIFA"  frameborder="0" allowfullscreen></iframe>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.b("\n"+i),o.b('<div id="closet-container" class="hide">'),o.b("\n"+i),o.b("  <p><strong>Your Closet</strong> This area contains the photos you haven't submitted yet. Select one to continue!</p>"),o.b("\n"+i),o.b('  <div class="closet-outfits-container"></div>'),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/closet_outfit"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b("<li>"),o.b("\n"+i),o.b("  <img src='"),o.b(o.v(o.d("images.medium.url",e,t,0))),o.b("' data-id='"),o.b(o.v(o.f("id",e,t,0))),o.b("' data-height='"),o.b(o.v(o.d("images.medium.height",e,t,0))),o.b("' data-width='"),o.b(o.v(o.d("images.medium.width",e,t,0))),o.b("' />"),o.b("\n"+i),o.b("  <span class='remove-item'></span>"),o.b("\n"+i),o.b("</li>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/confirmation"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="modal-header high-five-header">'),o.b("\n"+i),o.b("  <h2><span>High five!</span> Your photo has been succesfully uploaded.</h2>"),o.b("\n"+i),o.b('  <div class="modal-header" style="border-width:0">'),o.b("\n"+i),o.b('    <button type="button" id="close-hi-five" class="close hi-five" data-dismiss="modal" data-wizard-next="true" value=""></button>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"+i),o.b('<div class="modal-content high-five-body">'),o.b("\n"+i),o.b('  <div class="submitted">'),o.b("\n"+i),o.b("    <p class='what-now'><strong>What now?</strong></p>"),o.b("\n"+i),o.b("    <p>Our ModCommunity Hosts will double-check that it follows our Photo Guidelines.<br/>It should appear within 24-48 hours.</p>"),o.b("\n"+i),o.b('    <div class="photo-steps-container">'),o.b("\n"+i),o.b("      <ul class='photo-steps'>"),o.b("\n"+i),o.b('        <li class="your-photo">'),o.b("\n"+i),o.b('          <img src="'),o.b(o.v(o.d("images.medium.url",e,t,0))),o.b('" />'),o.b("\n"+i),o.b("        </li>"),o.b("\n"+i),o.b('        <li class="transistion"></li>'),o.b("\n"+i),o.b('        <li class="moderation"></li>'),o.b("\n"+i),o.b('        <li class="approval"></li>'),o.b("\n"+i),o.b("      </ul>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="meanwhile">'),o.b("\n"+i),o.b("      <h2>In the meantime, why don't you:</h2>"),o.b("\n"+i),o.b('      <div class="next-steps">'),o.b("\n"+i),o.b("        <p>"),o.b("\n"+i),o.b('          <img src="/style-gallery/assets/globe.png" alt="" />'),o.b("\n"+i),o.b('          Include a link to your personal website or blog. <a href="'),o.b(o.v(o.f("editAccountURL",e,t,0))),o.b('" target="_blank">Update Your Account &raquo;</a></p>'),o.b("\n"+i),o.b("      </div>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/confirmation_mobile"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="modal-header-directions">'),o.b("\n"+i),o.b('  <div class="header-directions-body">'),o.b("\n"+i),o.b("    <h4>Your photo has been submitted for review!</h4>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b('  <div class="close-icon">'),o.b("\n"+i),o.b('    <button class="close mobile-preview-cancel" data-dismiss="modal" data-wizard-next="true"></button>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"+i),o.b("<p>It should appear within 24-48 hours.</p>"),o.b("\n"+i),o.b('<div class="modal-header" style="border-width:0">'),o.b("\n"+i),o.b('  <button id="close-hi-five" class="close hi-five" data-dismiss="modal" data-wizard-next="true"></button>'),o.b("\n"+i),o.b("</div>"),o.b("\n"+i),o.b('<div class="outfit-photo">'),o.b("\n"+i),o.b('  <img src="'),o.b(o.v(o.d("images.medium.url",e,t,0))),o.b('" />'),o.b("\n"+i),o.b('  <span class="ribbon ribbon-3d-simple">Pending approval</span>'),o.b("\n"+i),o.b("</div>"),o.b("\n"+i),o.b('<a class="mc-button jumbo-btn" href="'),o.b(o.v(o.f("galleryURL",e,t,0))),o.b('">Go Back to the Style Gallery</a>'),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/instagram-photo"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<img class="thumb" src="'),o.b(o.v(o.f("image",e,t,0))),o.b('"/>'),o.b("\n"+i),o.b('<span class="border"></span>'),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/instagram"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('<div class="modal-header modal-header-directions">'),o.b("\n"+i),o.b('  <div class="header-directions-body">'),o.b("\n"+i),o.b("    <h4>Choose It</h4>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b('  <div class="close-icon">'),o.b("\n"+i),o.b('    <button class="close cancel"></button>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.b("\n"+i),o.b('<div class="row">'),o.b("\n"+i),o.b('  <div class="photo-guidelines"></div>'),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.b("\n"+i),o.b('<div class="photos loading">'),o.b("\n"+i),o.b('  <div class="instagram-photo-sheet-viewport"></div>'),o.b("\n"+i),o.b('  <button class="mc-button jumbo-btn instagram-add-photo">Add This Photo</button>'),o.b("\n"+i),o.b("</div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/outfit_preview"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b("\n"+i),o.b('  <div class="modal-header modal-header-directions">'),o.b("\n"+i),o.b('    <div class="back-btn">'),o.b("\n"+i),o.b('      <form accept-charset="UTF-8" action="'),o.b(o.v(o.f("formAction",e,t,0))),o.b('"'),o.b("\n"+i),o.b('        class="submit-photo-form" enctype="multipart/form-data" method="post" id="mobile-fileupload">'),o.b("\n"+i),o.b("        <div class='form-extras' style=\"margin:0;padding:0;display:inline\">"),o.b("\n"+i),o.b('          <input name="utf8" type="hidden" value="✓">'),o.b("\n"+i),o.b("        </div>"),o.b("\n"+i),o.b('        <button class="back-next-btn back-button mc-button fileinput-button">'),o.b("\n"+i),o.b("          &laquo; Back"),o.b("\n"+i),o.b('          <input id="mobile_outfit_image" name="outfit[image_attributes][media]" type="file">'),o.b("\n"+i),o.b("        </button>"),o.b("\n"+i),o.b("      </form>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="header-directions-body">'),o.b("\n"+i),o.b("      <h4>Photo Preview</h4>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="close-icon">'),o.b("\n"+i),o.b('      <button class="close mobile-preview-cancel"></button>'),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.b("\n"+i),o.b('  <div class="row">'),o.b("\n"+i),o.b('    <div class="photo-guidelines"></div>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.b("\n"+i),o.b('  <div class="row">'),o.b("\n"+i),o.b('    <div class="outfit-photo"><img src="'),o.b(o.v(o.d("images.medium.url",e,t,0))),o.b('"></div>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.b("\n"+i),o.b('  <div class="mobile-preview-controls row">'),o.b("\n"+i),o.b('    <button class="mc-button jumbo-btn mobile-preview-cancel">Cancel</button>'),o.b("\n"+i),o.b('    <button class="mc-button jumbo-btn mobile-preview-submit" data-wizard-next="true">Submit</button>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),this.HoganTemplates||(this.HoganTemplates={}),this.HoganTemplates["upload/product_tagger"]=new Hogan.Template({code:function(e,t,i){var o=this;return o.b(i=i||""),o.b('  <div id="upload-header-container">'),o.b("\n"+i),o.b('    <div class="modal-header header-steps">'),o.b("\n"+i),o.b('      <div class="steps">'),o.b("\n"+i),o.b('        <ul class="upload-photo-steps">'),o.b("\n"+i),o.b('          <li class="add-photo">'),o.b("\n"+i),o.b("            <p>Add Your Photo</p>"),o.b("\n"+i),o.b("          </li>"),o.b("\n"+i),o.b('          <li class="recreate-the-look active">'),o.b("\n"+i),o.b("            <p>Recreate the Look</p>"),o.b("\n"+i),o.b("          </li>"),o.b("\n"+i),o.b("        </ul>"),o.b("\n"+i),o.b("      </div>"),o.b("\n"+i),o.b('      <div class="close-icon">'),o.b("\n"+i),o.b('        <button class="close" data-wizard-previous="true" value="close"></button>'),o.b("\n"+i),o.b("      </div>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.b("\n"+i),o.b('  <div class="modal-header modal-header-directions">'),o.b("\n"+i),o.b('    <div class="back-btn">'),o.b("\n"+i),o.b('      <a class="back-next-btn back-button mc-button" data-wizard-previous="true" href="#">'),o.b("\n"+i),o.b('        <span class="nav-icon">'),o.b("\n"+i),o.b("          &laquo;"),o.b("\n"+i),o.b("        </span>"),o.b("\n"+i),o.b("        Back"),o.b("\n"+i),o.b("      </a>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="next-btn">'),o.b("\n"+i),o.b('      <a class="back-next-btn next-button mc-button" data-wizard-next="true" href="#">'),o.b("\n"+i),o.b("        Skip"),o.b("\n"+i),o.b('        <span class="nav-icon">&raquo;</span>'),o.b("\n"+i),o.b("      </a>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="header-directions-body">'),o.b("\n"+i),o.b("      <h4>Add items that appear in your look.</h4>"),o.b("\n"+i),o.b('      <p id="featured-inspired-intro">'),o.b("\n"+i),o.b("        <b>Know what?</b>"),o.b("\n"+i),o.b("        You can add items that inspired your look, too."),o.b("\n"+i),o.b("      </p>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.b("\n"),o.b("\n"+i),o.b('  <div class="row">'),o.b("\n"+i),o.b('    <div class="outfit-photo"><img src="'),o.b(o.v(o.d("images.medium.url",e,t,0))),o.b('"><span class="zoom">Zoom in</span></div>'),o.b("\n"+i),o.b('    <div class="initial-products-area">'),o.b("\n"+i),o.b("      <h4>Nothing here yet. Click the items you want to add.</h4>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="selected-products">'),o.b("\n"+i),o.b('      <button class="prev">&lt;&lt;</button>'),o.b("\n"+i),o.b('      <div class="carousel"></div>'),o.b("\n"+i),o.b('      <div class="add-more-items">'),o.b("\n"+i),o.b("        <h5>Add More<br/>Items"),o.b("\n"+i),o.b("        </h5>"),o.b("\n"+i),o.b("      </div>"),o.b("\n"+i),o.b('      <div class="carousel-decorator carousel-controls">'),o.b("\n"+i),o.b('        <a class="arrow left-arrow" href="#" data-carousel-slide="prev"></a>'),o.b("\n"+i),o.b('        <a class="arrow right-arrow" href="#" data-carousel-slide="next"></a>'),o.b("\n"+i),o.b("      </div>"),o.b("\n"+i),o.b('      <button class="next">&gt;&gt;</button>'),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.b("\n"+i),o.b('  <div class="row">'),o.b("\n"+i),o.b('    <div class="span2 menu-filters">'),o.b("\n"+i),o.b('      <ul class="right-filters">'),o.b("\n"+i),o.b('        <li class="active" data-source="order-history">Your Order History</li>'),o.b("\n"+i),o.b('        <li data-source="clothing">Browse ModCloth</li>'),o.b("\n"+i),o.b("      </ul>"),o.b("\n"+i),o.b('      <input type="text" id=\'search\' placeholder="Ex: red shoes" class="search-input-box"/>'),o.b("\n"+i),o.b("      <div class='search-btn'>"),o.b("\n"+i),o.b("        <a class='search' href='#'>"),o.b("\n"+i),o.b("          <i class='search-icon'></i>"),o.b("\n"+i),o.b("        </a>"),o.b("\n"+i),o.b("      </div>"),o.b("\n"+i),o.b('      <ul class="search-inputs">'),o.b("\n"+i),o.b('        <li class="active">Search Results</li>'),o.b("\n"+i),o.b("      </ul>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b('    <div class="products">'),o.b("\n"+i),o.b('      <div class="categories">'),o.b("\n"+i),o.b('        <ul class="category-btn">'),o.b("\n"+i),o.b('          <li class="active" data-slug="clothing">Clothing</li>'),o.b("\n"+i),o.b('          <li data-slug="dresses">Dresses</li>'),o.b("\n"+i),o.b('          <li data-slug="tops">Tops</li>'),o.b("\n"+i),o.b('          <li data-slug="bottoms">Bottoms</li>'),o.b("\n"+i),o.b('          <li data-slug="outerwear">Outerwear</li>'),o.b("\n"+i),o.b('          <li data-slug="shoes">Shoes</li>'),o.b("\n"+i),o.b('          <li data-slug="accessories">Accessories</li>'),o.b("\n"+i),o.b("        </ul>"),o.b("\n"+i),o.b("      </div>"),o.b("\n"+i),o.b('      <h4 class="no-products-msg"></h4>'),o.b("\n"+i),o.b('      <div class="unselected-products">'),o.b("\n"+i),o.b("        <ul></ul>"),o.b("\n"+i),o.b("      </div>"),o.b("\n"+i),o.b("    </div>"),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.b("\n"+i),o.b('  <div class="row">'),o.b("\n"+i),o.b('    <div class="photo-guidelines"></div>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.b("\n"+i),o.b('  <div class="modal-footer">'),o.b("\n"+i),o.b('    <a class="mc-button secondary-btn collection-prev" href="#">&laquo;</a>'),o.b("\n"+i),o.b('    <a class="mc-button secondary-btn collection-next" href="#">&raquo;</a>'),o.b("\n"+i),o.b("  </div>"),o.b("\n"),o.fl()},partials:{},subs:{}},"",Hogan,{}),StyleGallery.Models.Account=Backbone.Model.extend({url:function(){return window.router.paths.account()},initialize:function(){this.set({name:this.name()},{silent:!0})},name:function(){return this.has("firstName")?this.get("firstName"):"ModLover"},instagram:function(){return this.get("instagram")},reloadUser:function(){return $.post(window.router.paths.resetCurrentUser())}}),StyleGallery.Models.InstagramPhoto=Backbone.Model.extend({}),StyleGallery.Models.Outfit=StyleGalleryBase.Models.OutfitBase.extend({defaults:{user_loved:!1},initialize:function(e){_.bindAll(this,"_transformImage","_sortImages"),this.listenTo(this,"change:image",this._transformImage),this.listenTo(this,"change:images",this._sortImages),e&&e.image&&this._transformImage(this,e.image),this.setUserUploaded()},url:function(){return window.router.paths.outfit(this.get("id"))},love:function(e){if(!utils.redirectWhenSignedOut()){$.ajax({url:window.router.paths.loveAnOutfit(this.id),type:"POST"});var t=this.get("loves").account_ids;t.push(e),this.set({user_loved:!0,loves:{count:this.get("loves").count+1,account_ids:t}}),this.triggerLove()}},unLove:function(e){if(!utils.redirectWhenSignedOut()){$.ajax({url:window.router.paths.unLoveAnOutfit(this.id),type:"DELETE"});var t=_.reject(this.get("loves").account_ids,function(t){return e===t});this.set({user_loved:!1,loves:{count:this.get("loves").count-1,account_ids:t}}),this.triggerUnlove()}},triggerLove:function(){this.trigger("loved")},triggerUnlove:function(){this.trigger("unloved")},getUserLoved:function(e){return _.contains(this.get("loves").account_ids,e)},getUserUploaded:function(){return StyleGallery.currentUser&&this.get("contributor")?StyleGallery.currentUser.get("id")===this.get("contributor").id:!1},setUserUploaded:function(){StyleGallery.currentUser&&this.get("contributor")&&this.set("user_uploaded",this.getUserUploaded())},getImageUrl:function(e){var t=this._getOptimalImageSize(e);return t.url},_getOptimalImageSize:function(e){var t,i,o=this.get("images"),n=this.get("image_sort"),a=e||{},s=o.original;return i=function(e,t){var i=_.find(n,function(i){return t<=o[i][e]});return o[i]||s},_.has(a,"max-width")&&_.has(a,"max-height")?(t=s.width===_.max([s.width,s.height])?"width":"height",a[t]=a["max-"+t]):t=_.find(["width","height"],function(e){return a.hasOwnProperty(e)}),i(t,a[t])},_sortImages:function(e,t){var i,o,n=_.keys(t);i=_.sortBy(t,function(e){return e.width*e.height}),o=_.map(i,function(e){return n[_.indexOf(_.toArray(t),e)]}),this.set("image_sort",o)},_transformImage:function(e,t){if(_.isObject(t)!==!1){var i={},o=_.keys(t.sizes),n={full:"original",grid:"medium",overlay:"large"};_.each(o,function(e){var o=n[e],a=t.sizes[e];if(i[o]=_.omit(a,"retina"),a.hasOwnProperty("retina")){var s=t.sizes.full,r=_.min([2*a.width,s.width]),l=_.min([2*a.height,s.height]);i[o+"2x"]={url:a.retina,width:r,height:l}}}),this.set("images",i)}},parse:function(e){return _.has(e,"outfit")?e.outfit:e}}),window.StyleGallery.Models.OutfitsLayout=Backbone.Model.extend({defaults:{containerWidth:1034,height:0,idealColumnWidth:320,marginHoriz:15,marginVert:15},initialize:function(){this.stopListening(this,"change:containerWidth",this._reflowOutfits),this.listenTo(this,"change:containerWidth",this._reflowOutfits),this._defineProperties(this._calculatedProperties()),this._outfitViews={},this._orderedOutfitIds=[]},flowOutfits:function(e,t){t===!0&&(this._outfitViews={},this._orderedOutfitIds=[]),_.each(e,this._positionOutfit,this)},_reflowOutfits:function(){var e,t;t=function(e){this.unset(e)},mapOutfitViews=function(e){return this._outfitViews[e]},_.each(this._calculatedProperties(),t,this),e=_.map(this._orderedOutfitIds,mapOutfitViews,this),this.flowOutfits(e,!0)},_nextCoordinates:function(){var e,t,i;return e=this._shortestColumn(),t=this.columnHeights()[e],i=e*(this.columnWidth()+this.get("marginHoriz")),{top:t,left:i}},_incrementShortestColumn:function(e){this.columnHeights()[this._shortestColumn()]+=e+this.get("marginVert"),this.set("height",this._getHeight())},_containsOutfitId:function(e){return this._outfitViews.hasOwnProperty(e)},_positionOutfit:function(e){var t,i;return t=e.model.id,this._containsOutfitId(t)?(e.$el.remove(),void 0):(i=this._nextCoordinates(),e.setPositionAndScaleFactor(i.top,i.left,this.scaleFactor()),this._incrementShortestColumn(e.getHeight()),this._outfitViews[t]=e,this._orderedOutfitIds.push(t),void 0)},_calculatedProperties:function(){return["columnHeights","columnCount","columnWidth","scaleFactor"]},_defineProperties:function(e){var t=function(e){this[e]=function(){return this._fetchProperty(e)}};_.each(e,t,this)},_fetchProperty:function(e){if(this.has(e)===!1){var t="_calculate"+e.charAt(0).toUpperCase()+e.slice(1);this.set(e,this[t]())}return this.get(e)},_calculateColumnHeights:function(){for(var e=[],t=0;t<this.columnCount();t++)e.push(0);return e},_calculateColumnCount:function(){var e=Math.floor(this.get("containerWidth")/this.get("idealColumnWidth"));return 2>e?2:e},_calculateColumnWidth:function(){var e=this.get("marginHoriz")*(this.columnCount()-1);return Math.floor((this.get("containerWidth")-e)/this.columnCount())},_calculateScaleFactor:function(){return this.columnWidth()/this.get("idealColumnWidth")},_shortestColumn:function(){var e=_.min(this.columnHeights());return _.indexOf(this.columnHeights(),e)},_getHeight:function(){return _.max(this.columnHeights())}}),StyleGallery.Models.Product=Backbone.Model.extend({initialize:function(){StyleGalleryBase.Models.Lockable.mixin(this)},url:function(){return window.router.paths.cachedProduct(this.get("id"))},fade:function(){this.set({faded:!0},{silent:!0})}}),StyleGallery.Collections.CatalogProducts=Backbone.Paginator.requestPager.extend({paginator_core:{dataType:function(){var e=window.initialBackboneData.apiUrl.indexOf(".demo.modcloth.com")>-1;return"order-history"==this.slug&&e?"jsonp":"json"},url:function(){return"perform-search"==this.slug?this.url:"order-history"==this.slug?this.orderHistoryApiUrl():window.router.paths.productsByCatalogSlug(this.slug)}},paginator_ui:{firstPage:1,currentPage:1,perPage:10},server_api:{per_page:10,page:function(){return this.currentPage}},defaultSlug:"order-history",setDefaultSlug:function(){this.slug=this.defaultSlug},model:StyleGallery.Models.Product,initialize:function(e,t){t=_.defaults({slug:this.defaultSlug}),this.slug=t.slug,StyleGalleryBase.Collections.Change.mixin(this)},parse:function(e){return e&&e.products?e.products:e},orderHistoryApiUrl:function(){var e=window.initialBackboneData.apiUrl+"/api/v1/accounts/";return utils.onAdminPath()&&(e+=this.userId+"/"),e+="orders/products"}}),StyleGallery.Collections.CurrentUserClosetOutfits=Backbone.Collection.extend({model:StyleGallery.Models.Outfit,url:function(){return window.router.paths.userCloset()}}),StyleGallery.Collections.Outfits=Backbone.Collection.extend({model:StyleGallery.Models.Outfit}),StyleGallery.Collections.PaginatedCollectionOutfits=Backbone.Paginator.requestPager.extend({model:StyleGallery.Models.Outfit,resourceUrl:function(){},isLastPage:function(){return this.currentPage===this.totalPages},paginator_core:{dataType:"json",cache:!0,url:function(){return this.resourceUrl()}},paginator_ui:{firstPage:1,currentPage:1,perPage:6},server_api:{page:function(){return this.currentPage}},parse:function(e){return this.perPage=e.pagination.per_page,this.totalPages=e.pagination.total_pages,this.currentPage=e.pagination.page,this.totalRecords=e.pagination.total_items,e.outfits}}),StyleGallery.Collections.PaginatedInstagramPhotos=Backbone.Paginator.requestPager.extend({model:StyleGallery.Models.InstagramPhoto,data:[],paginator_core:{url:function(){var e=StyleGallery.currentUser.instagram().uid;return window.router.paths.instagram.user.recent(e)}},server_api:function(){var e={access_token:StyleGallery.currentUser.instagram().access_token,count:this.perPage};return this.max_id&&_.extend(e,{max_id:this.max_id}),e},paginator_ui:{firstPage:1,currentPage:1,perPage:30},initialize:function(){StyleGalleryBase.Collections.Change.mixin(this)},parse:function(e){this.totalPages=_.isEmpty(e.pagination)?this.currentPage:this.currentPage+1,this.max_id=e.pagination.next_max_id;var t=_.filter(e.data,function(e){return"image"==e.type});return this.data=this.data.concat(t),this.data}}),StyleGallery.Collections.PaginatedOutfits=Backbone.Paginator.requestPager.extend({model:StyleGallery.Models.Outfit,activeScope:"",activeFilter:"",selectedScope:"latest",selectedFilter:"all",isLastPage:function(){return this.currentPage===this.totalPages},paginator_core:{dataType:"json",cache:!0,url:function(){return window.router.paths.outfits()}},paginator_ui:{firstPage:1,currentPage:1,perPage:6},server_api:{page:function(){return this.currentPage},scope:function(){return this.activeScope=this.selectedScope},filter:function(){return this.activeFilter=this.selectedFilter}},initialize:function(){StyleGalleryBase.Collections.Change.mixin(this)},parse:function(e){return this.perPage=e.pagination.per_page,this.totalPages=e.pagination.total_pages,this.currentPage=e.pagination.page,this.totalRecords=e.pagination.total_items,e.outfits}}),StyleGallery.Collections.PaginatedOutfitsByContributor=StyleGallery.Collections.PaginatedCollectionOutfits.extend({resourceUrl:function(){return window.router.paths.contributorOutfits(this.contributorId)},initialize:function(e){this.contributorId=e.contributorId,StyleGalleryBase.Collections.Change.mixin(this)}}),StyleGallery.Collections.PaginatedOutfitsByTag=StyleGallery.Collections.PaginatedCollectionOutfits.extend({resourceUrl:function(){return window.router.paths.taggedOutfits(window.initialBackboneData.resourceIdentifier)},initialize:function(){StyleGalleryBase.Collections.Change.mixin(this)}}),StyleGallery.Collections.Products=Backbone.Collection.extend({url:function(){return window.router.paths.productCacheApi()},model:StyleGallery.Models.Product,initialize:function(e,t){t=t||{},t.url&&(this.url=t.url),StyleGalleryBase.Collections.Dirty.mixin(this)}}),StyleGalleryBase.Views.CarouselView=Backbone.View.extend({pageSize:1,isReadyForCarousel:!0,loop:!1,initialize:function(){_.bindAll(this,"prev"),_.bindAll(this,"next"),_.bindAll(this,"_onFlip"),_.bindAll(this,"collectionChange"),_.bindAll(this,"_modelAdded"),$("body").off("click",'[data-carousel-slide="prev"]',this.prev),$("body").on("click",'[data-carousel-slide="prev"]',this.prev),$("body").off("click",'[data-carousel-slide="next"]',this.next),$("body").on("click",'[data-carousel-slide="next"]',this.next),$("body").off("click","[data-carousel-go]",this.go),$("body").on("click","[data-carousel-go]",this.go),this.listenTo(this.collection,"add",this._modelAdded),this.listenTo(this.collection,"reset",this.collectionChange),this.listenTo(this.collection,"remove",this.collectionChange),this.listenTo(this.collection,"add",this.collectionChange),this.listenTo(this,"carousel-view:change",this._syncCollectionPage)},collectionChange:function(){this.isReadyForCarousel&&(this._swipeview?(this._swipeview.updatePageCount(this._numberOfPages()),this._swipeview.goToPage(this._swipeview.page),this._rerenderMasterPages()):this.setupCarousel(),this.trigger("carousel-view:change"))},setupCarousel:function(){if(this.isReadyForCarousel){var e=this._swipeview=new SwipeView(_.result(this,"carouselEl")||this.el,{numberOfPages:this._numberOfPages(),loop:this.loop});e.goToPage(this.collection.page||0),this._rerenderMasterPages(),e.onFlip($.proxy(this._onFlip,this))}},_syncCollectionPage:function(){this.collection.page=this._swipeview.page},_modelAdded:function(){this._swipeview&&(this._swipeview.updatePageCount(this._numberOfPages()),this._swipeview.goToPage(this._numberOfPages()-1))},_rerenderMasterPages:function(){for(var e=this._swipeview.page,t=this._swipeview.currentMasterPage,i=0;3>i;i++){var o=this._swipeview.masterPages[i].dataset.upcomingPageIndex;o==""+e&&i!=t?$(this._swipeview.masterPages[i]).html(""):$(this._swipeview.masterPages[i]).html("").append(this.renderPage(o))}},_onFlip:function(){var e,t,i,o=this._swipeview.page;for(i=0;3>i;i++)e=this._swipeview.masterPages[i].dataset.upcomingPageIndex,t=this._swipeview.masterPages[i].dataset.pageIndex,e==""+o&&i!=this._swipeview.currentMasterPage?$(this._swipeview.masterPages[i]).html(""):e!=t&&$(this._swipeview.masterPages[i]).html("").append(this.renderPage(e));this.trigger("carousel-view:change")},_numberOfPages:function(){return Math.ceil(this.collection.size()/this.pageSize)},isFirstPage:function(){return 0==this._swipeview.page},isLastPage:function(){return this._swipeview.page==this._numberOfPages()-1},prev:function(e){e.preventDefault(),this._swipeview&&this._swipeview.prev()},next:function(e){e.preventDefault(),this._swipeview&&this._swipeview.next()},go:function(e){e.preventDefault();var t=$(e.target).data("carousel-go");t&&this._swipeview&&this._swipeview.goToPage(t)},renderPage:function(e){var t,i=$("<div/>"),o=e*this.pageSize,n=this;return _(this.collection.slice(o,o+this.pageSize)).each(function(e,o){t=n.renderItem(e,o),i.append(t)}),i},renderItem:function(){}}),StyleGallery.Views.ShopTheLookView=Backbone.View.extend({className:"shop-the-look",events:{"click .grid-toggle":"toggleGridView"},initialize:function(){_dbg.log("[ShopTheLookView::initialize]"),this.defaultViewType="grid"},render:function(){var e,t;utils.device.phone()?(e=!1,t=!0):(e=this.collection.length>3,t=!1);var i={displayNavigation:e,displayViewSwitcher:t},o=HoganTemplates["gallery/shop_the_look"].render(i);return this.$el.html(o),utils.device.phone()?this.renderProducts():this.renderProductsCarousel(),this},renderProducts:function(){this.$(".product-list").addClass(this.defaultViewType),this.$(".grid-toggle[data-view-type="+this.defaultViewType+"]").addClass("active"),this.collection.each(function(e){var t=new StyleGallery.Views.ShopTheLookProductView({model:e});this.$(".product-list").append(t.render().el)},this)},renderProductsCarousel:function(){var e=[];this.collection.each(function(t){var i=new StyleGallery.Views.ShopTheLookProductView({model:t});e.push(i.render().el)},this);for(var t=0;t<e.length;t+=3){var i=$("<div/>",{"class":"products-page item"}).html(e.slice(t,t+3));this.$(".product-list .carousel-inner").append(i)}this.$(".product-list").find(".products-page").first().addClass("active")},toggleGridView:function(e){e.preventDefault();var t=$(e.target);if("IMG"===e.target.tagName&&(t=t.parents("a")),!t.hasClass("active"))if($(".grid-toggle").toggleClass("active"),$(".product-list").attr("class","product-list").addClass(t.data("view-type")),"grid"===t.data("view-type")){var i=Math.max.apply(null,$(".product").map(function(){return $(this).height()}).get());$(".product").css("height",i)}else $(".product").css("height","auto")}}),StyleGallery.Views.ClosetItemView=Backbone.Marionette.ItemView.extend({template:"upload/closet_outfit",events:{"click img":"imageClicked","click .remove-item":"removeItemClicked"},imageClicked:function(){var e=this.model.get("id");e&&(window.currentWizard.data.outfitId=e,window.currentWizard.renderNextStep())},removeItemClicked:function(){this.model.destroy()}}),StyleGallery.Views.ClosetOutfitsView=Backbone.Marionette.CollectionView.extend({className:"closet-outfits",tagName:"ul",itemView:StyleGallery.Views.ClosetItemView,attached:!1,initialize:function(){_dbg.log("[ClosetOutfitsView::initialize]"),this.listenTo(this.collection,"sync",this.render)},onRender:function(){this.collection.length>0?(this.attached||(this.$el.appendTo($("#closet-container .closet-outfits-container")),this.attached=!0),this.setScrollerWidth(),$("#closet-container").removeClass("hide")):$("#closet-container").addClass("hide")},onItemRemoved:function(){0===this.collection.length&&$("#closet-container").addClass("hide")},setScrollerWidth:function(){var e=50,t=0,i=140;this.$("li").each(function(e,o){var n=i/$("img",o).data("height"),a=$("img",o).data("width")*n;t+=Math.round(a)+20});var o=t+e;this.$el.css("width",o)}}),StyleGallery.Views.FilterView=Backbone.View.extend({tagName:"ul",id:"filters",selectedFilter:"all",events:{"click li a":"handleClick"},initialize:function(e){_.bindAll(this,"setSelectedFilterFromPath","setValidFilters"),this.scope=e.scope,this.filters=this.filtersForScope(e.scope),this.setValidFilters(this.filters),this.paginator=e.paginator,"loved"===this.scope&&(this.selectedFilter="week")},render:function(){var e=this;return this.setSelectedFilterFromPath(window.location.pathname),$("ul#filters").length>0&&this.setElement($("ul#filters")),this.$el.empty(),this.filters.length>0&&_.each(this.filters,function(t,i){var o="";t.slug==e.selectedFilter&&(o="active");var n;i>0&&(n="|"),e.$el.append($("<li/>",{"class":"filter"}).text(n).append($("<a/>",{"data-path":window.router.paths.gallery(e.scope)+"/"+t.slug,href:"/style-gallery"+window.router.paths.gallery(e.scope)+"/"+t.slug,"class":o,id:t.slug}).text(t.name)))}),$("#scopes").after(this.el),this.paginator.selectedFilter=this.selectedFilter,this},filtersForScope:function(e){var t=[];switch(e){case"loved":t=[{name:"All Time",slug:"all"},{name:"This Week",slug:"week"},{name:"Today",slug:"today"}]}return t},setValidFilters:function(e){this.validFilters=_.map(e,function(e){return e.slug})},handleClick:function(e){e.preventDefault();var t=$(e.target),i=t.attr("data-path");$("#filters a.active").removeClass("active"),t.addClass("active"),this.selectedFilter=this.paginator.selectedFilter=t.attr("id"),window.router.navigate(i,{trigger:!0})
},setSelectedFilterFromPath:function(e){var t=/^\/style-gallery\/\w+\/(\w+)/.exec(e);t&&_.contains(this.validFilters,t[1])&&(this.selectedFilter=t[1])}}),function(e){"use_strict";StyleGallery.Views.GalleryDefaultUploadView=Marionette.Layout.extend({className:"gallery-upload",template:"upload/choose_file",viewName:"Upload",narrowModal:!0,uploadErrors:[],loading:!1,initialize:function(){_.bindAll(this,"onViewDidRender"),this.listenTo(this,"viewDidRender",this.onViewDidRender)},serializeData:function(){return{errors:this.uploadErrors,showErrors:this.uploadErrors.length>0,loading:this.loading,formAction:router.paths.api.outfits()}},renderCloset:function(){_dbg.log("[GalleryUploadView::renderCloset]");var e=new StyleGallery.Views.ClosetOutfitsView({collection:new StyleGallery.Collections.CurrentUserClosetOutfits});e.collection.fetch({reset:!0})},bindUploadInput:function(){var t=this;e("#fileupload").fileupload({dataType:"json",start:function(){t.uploadErrors=[],t.loading=!0,t.render()},always:function(){t.loading=!1},success:function(e){this.uploadErrors=[],window.currentWizard.data.outfitId=e.outfit.id,window.currentWizard.renderNextStep()},error:function(e){t.uploadErrors=JSON.parse(e.responseText).errors.image,t.loading=!1,t.render(),t.bindUploadInput()}})},onViewDidRender:function(){this.bindUploadInput(),this.renderCloset()}})}(jQuery),function(e){"use_strict";StyleGallery.Views.GalleryInstagramUploadView=Marionette.Layout.extend({className:"instagram-upload",template:"upload/instagram",regions:{guidelines:".photo-guidelines",photoSheet:".instagram-photo-sheet-viewport"},events:{"click .instagram-load-next":"loadNext","click .instagram-add-photo":"upload","click .cancel":"cancel"},viewport:function(){return utils.device.phone()?e(".modal"):e(".instagram-photo-sheet-viewport")},initialize:function(){StyleGalleryBase.Views.InfiniteScrollView.mixin(this),_.bindAll(this,"onSelect","onDeselect","photosAdded"),this.on("paginate",this.loadNext)},serializeData:function(){return{formAction:router.paths.api.outfits()}},onRender:function(){this.photoSheetView=new StyleGallery.Views.InstagramPhotoSheetView({collection:new StyleGallery.Collections.PaginatedInstagramPhotos}),this.photoSheetView.on("deselect",this.onDeselect),this.photoSheetView.on("select",this.onSelect),this.photoSheetView.collection.on("change:done",this.photosAdded),this.photoSheetView.collection.on("change:done",this.unpauseScrollPoller),this.photoSheetView.collection.goTo(1),utils.ensureMobileModalHeader()},onShow:function(){this.photoSheet.show(this.photoSheetView),this.guidelines.show(new StyleGallery.Views.PhotoGuidelinesView)},onSelect:function(e){this.selected=e,this.$el.addClass("photo-selected")},onDeselect:function(){this.selected=!1,this.$el.removeClass("photo-selected")},loadNext:function(){this.photoSheetView.collection.requestNextPage()},photosAdded:function(){var e=this.$(".photos"),t=this.photoSheetView.collection;e.hasClass("loading")&&(e.removeClass("loading"),this.startScrollPoller()),t.currentPage==t.totalPages&&(e.addClass("no-more-photos"),this.endScrollPoller())},cancel:function(){window.currentWizard.close()},upload:function(){if(this.selected){var t=this.selected.model.get("images").standard_resolution.url;return this.$(".instagram-add-photo").addClass("loading").text("Uploading..."),e.ajax({type:"POST",url:router.paths.api.outfits(),dataType:"json",data:{utf8:"✓",close_path:"","outfit[image_attributes][url]":t}}).done(function(e){var t=e.outfit.id;router.navigate(router.paths.submitOutfit(t),{trigger:!0})}),!1}}})}(jQuery),function(){"use_strict";StyleGallery.Views.GalleryUploadView=Marionette.Layout.extend({template:"upload/base",narrowModal:!0,viewName:"Desktop Photo Picker",regions:{view:".base"},options:{mode:"device"},viewWillRender:function(e){_.extend(this.options,e)},viewDidRender:function(e){this.view.currentView.trigger("viewDidRender",e)},onRender:function(){this.$el.appendTo(".modal#uploadWizard"),"instagram"==this.options.mode?(this.route=window.router.paths.galleryInstagramUpload(),this.view.show(new StyleGallery.Views.GalleryInstagramUploadView)):(this.route=window.router.paths.galleryUpload(),this.view.show(new StyleGallery.Views.GalleryDefaultUploadView))}})}(jQuery),function(e){"use strict";StyleGallery.Views.InstagramPhotoSheetView=Marionette.CollectionView.extend({className:"instagram-photo-sheet",initialize:function(){_.bindAll(this,"deselect"),this.itemView=StyleGallery.Views.InstagramPhotoView},onRender:function(){this.$el.find(".spindicator").remove(),this.$el.append('<p class="spindicator"><img alt="Spindicator-loader" src="/style-gallery/assets/spindicator-loader.gif">Loading…</p>')},onShow:function(){e("body").on("click",this.deselect)},beforeClose:function(){e("body").off("click",this.deselect)},onItemviewClick:function(){this.deselect()},deselect:function(){this.$(".instagram-uploadable-photo").removeClass("selected"),this.trigger("deselect")},onItemviewSelect:function(e){this.trigger("select",e)}})}(jQuery),function(){"use strict";StyleGallery.Views.InstagramPhotoView=Marionette.ItemView.extend({template:"upload/instagram-photo",className:"instagram-uploadable-photo",tagName:"a",attributes:{href:"javascript:void(0);"},events:{click:"onClick"},serializeData:function(){return{image:this.model.get("images").thumbnail.url}},onClick:function(){var e=!this.$el.hasClass("selected");return this.trigger("click"),e&&this.select(),!1},select:function(){this.$el.addClass("selected"),this.trigger("select",this)}})}(jQuery),function(){"use_strict";StyleGallery.Views.LoveButtonView=Marionette.ItemView.extend({template:"gallery/love_button",events:{"click .love-button":"respondToLoveRequest"},modelEvents:{change:"render",loved:"renderHeartAnimation"},serializeData:function(){return _.extend(this.model.get("loves"),{state:this.userLoved()?"loved":"unloved"})},respondToLoveRequest:function(){utils.redirectWhenSignedOut()||(this.userLoved()?this.model.unLove(StyleGallery.currentUser.get("id")):this.model.love(StyleGallery.currentUser.get("id")))},userLoved:function(){return StyleGallery.currentUser?this.model.getUserLoved(StyleGallery.currentUser.get("id")):!1},renderHeartAnimation:function(){this.$el.find(".heart").addClass("animated")}})}(jQuery),function(e){"use strict";StyleGallery.Views.OutfitDetailView=Backbone.View.extend({className:"outfit-detail",events:{"click #back-btn":"backButtonPressed"},templateHelpers:{moderatedAtTimeAgo:function(){return utils.onAdminPath()?moment(this.attributes.created_at).fromNow():moment(this.attributes.moderated_at).fromNow()},user_personal_website:function(){return this.attributes.contributor.personal_website_url||!1}},initialize:function(){_dbg.log("[OutfitDetailView::initialize]"),this.listenTo(this.model,"change",this.updateAnalyticsContext),this.listenTo(this.model,"change",this.render),_e.off("modal:hide",this.viewDidClose),_e.on("modal:hide",this.viewDidClose,this),_e.off("window:resize",this.constrainImage),_e.on("window:resize",this.constrainImage,this),_e.off("orientationDidChange",this.constrainImage),_e.on("orientationDidChange",this.constrainImage,this),_e.off("scroll:bottom",this._handleScrollToBottom),_e.on("scroll:bottom",this._handleScrollToBottom,this),this.bindAnalytics(this.model),this.loveButton=new StyleGallery.Views.LoveButtonView({model:this.model}),this.onClosePath=this.options.onClosePath||(initialBackboneData.resourceIdentifier?initialBackboneData.resourceIdentifier:window.router.paths.gallery()),this.sharingWidget=new StyleGallery.Views.SocialSharingWidget({model:this.model}),this.setTemplates()},closePath:function(){return utils.onAdminPath()?null:utils.addScopeToGalleryPath(this.onClosePath)},setTemplates:function(){utils.device.phone()?(this.showInModal=!1,this.template=HoganTemplates["gallery/phone/outfit_detail"]):(this.showInModal=!0,this.template=HoganTemplates["gallery/outfit_detail"])},bindAnalytics:function(){mc_shared_assets.analytics.services.ga.addBuilder(function(e){return"user clicked product"==e?["style-gallery:outfit","user_actions","shop-the-look",1]:void 0})},updateAnalyticsContext:function(){mc_shared_assets.trigger("pushContext",{outfitModel:this.model})},viewDidClose:function(){_dbg.log("[OutfitDetailView::viewDidClose]"),_e.trigger("outfitDetail:didClose"),mc_shared_assets.analytics.api.pushContext({currentView:""})},render:function(){_.extend(this.model,this.templateHelpers);var t=new StyleGallery.Views.ShopTheLookView({collection:new StyleGallery.Collections.Products(this.model.get("products"))}),i=this.template.render(this.model);if(this.$el.html(i),this.$el.find(".user-details").after(t.render().el),this.tagsView=new StyleGallery.Views.TagsView({tags:this.model.get("tags")}),this.$el.find(".shop-the-look").after(this.tagsView.render().el),this.showInModal)this._showModal(this.el,this.closePath()),this.constrainImage();else{if(0===e(".outfit-detail").length){this.scrollPos=e(window).scrollTop();var o=e("<div/>",{id:"outfit-detail-container","class":"content-container"});o.html(this.el),e(".container-fluid").before(o)}e(".container-fluid").hide(),utils.ensureMobileModalHeader(e("#outfit-detail-container .outfit-detail"))}return this.loveButton.setElement(this.$(".bb-love-button")),this.loveButton.render(),utils.onAdminPath()||(this.sharingWidget.setElement(this.$el.find(".share-widget")),this.sharingWidget.render()),mc_shared_assets.analytics.api.pushContext({currentView:"outfitDetailView"}),mc_shared_assets.analytics.dom_binding.bindAll(),_e.trigger("outfitDetail:didRender"),this},constrainImage:function(){var t=.9*e(window).height(),i=.6*e(window).width();e(window).width()<900&&(i=.35*e(window).width()),this.$el.find(".main-image-container img").css({"max-height":parseInt(t,10),"max-width":parseInt(i,10)}),this.$el.find(".main-image-container").css({"max-height":parseInt(t,10),"max-width":parseInt(i,10)})},backButtonPressed:function(e){e.preventDefault(),this.removePhoneView()},removePhoneView:function(){_dbg.log("[OutfitDetailView::removePhoneView]"),e("#outfit-detail-container").remove(),e(".container-fluid").show(),e(window).scrollTop(this.scrollPos);var t=0===StyleGallery.outfitCollectionView.collection.length;window.router.navigate(this.closePath(),t),this.viewDidClose()},close:function(){this.stopListening(this.model),utils.device.phone()?this.removePhoneView():Modal.View.isShowing()&&Modal.View.hide()},_handleScrollToBottom:function(){e(window).data("scrollAjaxReady",!0)},_showModal:function(e,t){var i=window.Modal.View.model;i.set({content:e,onClosePath:t,wideModal:!0},{silent:!0}),i.show()}})}(jQuery),StyleGallery.Views.ScopeView=Backbone.View.extend({tagName:"ul",id:"scopes",selectedScope:"latest",initialize:function(e){this.validScopes=e,this.paginatorScope,this.filterView,_.bindAll(this,"renderFilters","setSelectedScopeFromPath","setSelectedScope","registerPaginator")},events:{"click a":"handleClick"},render:function(){var e=this;return this.setSelectedScopeFromPath(window.location.pathname),e.$el.empty(),_.each(this.validScopes,function(t){var i="";t===e.selectedScope&&(i="active"),e.$el.append($("<li/>",{"class":"scope"}).append($("<a/>",{src:window.router.paths.gallery(t),"class":i,id:t}).text(e.humanReadableScope(t))))}),$("#gallery").before(this.el),this.renderFilters(),this.paginator.selectedScope=this.selectedScope,this},renderFilters:function(e){this.filterView&&this.filterView.remove(),this.filterView=new StyleGallery.Views.FilterView({scope:this.selectedScope,paginator:this.paginator}),this.filterView.render(),e&&window.router.navigate(e,{trigger:!0})},handleClick:function(e){e.preventDefault();var t=$(e.target),i=t.attr("id");this.setSelectedScope(i)},setSelectedScope:function(e){var t=window.router.paths.gallery(e);this.selectedScope=this.paginator.selectedScope=e,$("#scopes a.active").removeClass("active"),this.$el.find("#"+e).addClass("active"),this.renderFilters(t)},setSelectedScopeFromPath:function(e){var t=/^\/style-gallery\/(\w+)/.exec(e);t&&_.contains(this.validScopes,t[1])&&(this.selectedScope=t[1])},registerPaginator:function(e){this.paginator=e},humanReadableScope:function(e){return"loved"===e?"most loved":e}}),StyleGallery.Views.ShopTheLookProductView=Backbone.View.extend({className:"product span3",tagName:"div",attributes:function(){var e={};return e["data-id"]=this.model.get("id"),utils.device.phone()&&(e.style="height:270px;"),e},render:function(){var e="_blank";Modernizr.touch&&(e="_self");var t="pictured"==this.model.get("rel")||!1,i=HoganTemplates["gallery/product"].render(_.extend(this.model.toJSON(),{clickTarget:e,picturedItem:t}));return this.$el.html(i),this}}),StyleGallery.Views.SliverView=Backbone.View.extend({id:"sliver",className:"sliver opened",tagName:"div",monetatePollingTime:1e3,initialize:function(){this.bind("monetateContentLoaded",this.makeSliverVisible),this.$el.addClass("hidden"),this.pollForContent()},events:{"click #sliver-header, #sliver-toggle-icon":"checkToggle","tap #sliver-header, #sliver-toggle-icon":"checkToggle"},render:function(){var e=HoganTemplates["gallery/sliver"].render();return this.$el.html(e),$("#style-gallery-banner").after(this.$el),this},setDefaultValues:function(){$("#sliver-header").html("STYLE ASSIGNMENT"),$("#sliver-content").html("Wow us with a 'white out'. Check out how we're styling whites, and show us your take by up.")},checkToggle:function(){var e=this;$("#sliver-toggle-icon").is(":visible")&&e.slideToggle()},slideToggle:function(){var e=this;$("#sliver-content").slideToggle(function(){var t;$(this).is(":visible")?(e.$el.addClass("opened"),e.$el.removeClass("closed"),t="&#8211;"):(e.$el.addClass("closed"),e.$el.removeClass("opened"),t="+"),$("#sliver-toggle-icon").html(t)})},makeSliverVisible:function(){this.$el.removeClass("hidden")},pollForContent:function(){this.monetateContentPresent()?this.trigger("monetateContentLoaded"):setTimeout(_.bind(this.pollForContent,this),this.monetatePollingTime)},monetateContentPresent:function(){return!!this.$el.find("#sliver-content").text()}}),StyleGallery.Views.SocialSharingWidget=Backbone.View.extend({className:"share-widget",render:function(){return this.$el.socialShareProduct({product_id:this.model.get("id"),product_url:this.shareURL(),product_image_url:this.shareImageURL(),tweet:this.twitterText(),pin:this.pinterestText(),facebook_title:this.facebookTitle(),product_summary:this.facebookDescription(),redirect_url:this.redirectUrl(),services:"Pinterest,Twitter,Facebook",device_type:utils.device.type,ga_utm_medium:"share",ga_utm_campaign:this.gaUtmCampaign(),ga_utm_keyword:this.model.get("id")}),this},facebookTitle:function(){return"I ♥ "+this.model.get("contributor").name+"'s look!"},facebookDescription:function(){return"I spotted this outstanding outfit on the ModCloth Style Gallery. You can view, love, and share your own fashionable photos with the ModCloth community, too!"},twitterText:function(){return"I’ve got a crush on this look from the @ModCloth Style Gallery! "},pinterestText:function(){return"<3 this look from the ModCloth Style Gallery! Cutest community ever. #indie #style"},shareURL:function(){return"http://"+window.location.host+"/style-gallery"+window.router.paths.galleryOutfit(this.model.get("id"))},shareImageURL:function(){return this.model.get("images").original.url},redirectUrl:function(){return"http://www.modcloth.com"+window.location.pathname},gaUtmCampaign:function(){if(window.location.pathname.match(/\/outfits\/\d/))var e="outfitshare";else e="galleryshare";return"sg_"+e}}),StyleGallery.Views.SubtitleBaseView=Backbone.Marionette.ItemView.extend({id:"inspire-admire",className:"subtitle",template:"gallery/subtitle",defaults:{subtitle:"Inspire <span class='glyph glyph-and'></span> Admire"},initialize:function(e){this.options=_.defaults({},e,this.defaults)},serializeData:function(){return{subtitle:this.options.subtitle}},onRender:function(){_dbg.log("[SubtitleBaseView::render]")}}),StyleGallery.Views.SubtitleTagView=StyleGallery.Views.SubtitleBaseView.extend({id:"tag-title",modelEvents:{change:"render"},initialize:function(e){this.options=_.defaults({},e,this.defaults),this.model=StyleGallery.currentProfile},onBeforeRender:function(){var e=this.getTag();this.options.subtitle=this._formatTagName(e)},onRender:function(){_dbg.log("[SubtitleTagView::render]")},getTag:function(){var e=StyleGallery.currentProfile,t=e&&e.displayName();return t?t:window.initialBackboneData.tag_name},_formatTagName:function(e){return(e||"").replace(" / ","/")}}),$(function(){"use strict";StyleGallery.Views.TagView=Backbone.View.extend({tagName:"li",initialize:function(e){this.tag=e.tag,this.name=this.tag.name,this.colorTag=this.isColorTag()?this.name.toLowerCase():!1,this.url="/style-gallery/"+this.tag.slug},isColorTag:function(){return"Primary Color"==this.tag.category},render:function(){var e=HoganTemplates["gallery/tag"].render(this);return this.$el.html(e),this}})}),$(function(){"use strict";StyleGallery.Views.TagsView=Backbone.View.extend({id:"outfit-tags",tagName:"ul",tagViews:[],initialize:function(e){this.tags=e.tags||[]},render:function(){_dbg.log("[TagsView::render]");for(var e=0;e<this.tags.length;e++)"live"==this.tags[e].state&&(this.tagViews[e]=new StyleGallery.Views.TagView({tag:this.tags[e]}),this.$el.append(this.tagViews[e].render().el));return this}})}),StyleGallery.Views.TitleBannerView=Backbone.Marionette.ItemView.extend({id:"style-gallery-title",tagName:"a",className:"title curve",isTouch:!1,attributes:{href:"/style-gallery"},template:"gallery/title_banner",onRender:function(){_dbg.log("[TitleBannerView::render]"),this._createTitle()},_createTitle:function(){for(var e=this.$el.html()||"",t="",i=0;i<e.length;i++)t+="<span class='letter letter-"+i+"'>"+e.charAt(i)+"</span>";this.$el.html(t)}}),StyleGallery.Views.TitleButtonView=Backbone.Marionette.ItemView.extend({id:"upload-button",tagName:"button",template:"gallery/title_button",events:{click:"openUploadModal"},serializeData:function(){return{iconClass:"glyph camera",label:"Add Your Photo"}},openUploadModal:function(){window.router.navigate(window.router.paths.galleryUpload(),{trigger:!0})}}),StyleGallery.Views.TitleFollowButtonView=StyleGallery.Views.TitleButtonView.extend({id:"follow-button",triggers:{click:"followClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"},modelEvents:{change:"render"},defaults:{content:{following:{iconClass:"glyph checkmark",label:"Following"},unfollowHover:{iconClass:"glyph x",label:"Unfollow"},unfollowed:{iconClass:"glyph plus",label:"Follow"}}},initialize:function(e){this.options=_.defaults({},e,this.defaults),this.model=StyleGallery.currentProfile,this.hover=this.mouseover=!1},state:function(){return this.model.isFollowedByCurrentUser()?this.hover?"unfollowHover":"following":"unfollowed"},serializeData:function(){var e=_.result(this,"state");return this.options.content[e]},onRender:function(){this.$el.toggleClass("following",this.model.isFollowedByCurrentUser())},onFollowClick:function(){this.model.isFollowedByCurrentUser()?this.model.unfollow():this.model.follow(),this.adjustHoverAndFocus()},adjustHoverAndFocus:function(){this.mouseover&&this.$el.blur(),this.hover=!1,this.render()},onMouseEnter:function(){this.hover=this.mouseover=!0,this.render()},onMouseLeave:function(){this.hover=this.mouseover=!1,this.render()}}),StyleGallery.Views.UploadBarErrorsView=Marionette.ItemView.extend({template:"gallery/upload_bar_errors",events:{"click .close":"close"},className:"upload-bar-errors",serializeData:function(){return _.defaults({prefix:"ours"==this.model.get("fault")?"Sorry!":"Uh-oh!"},this.model.toJSON())},onRender:function(){this.options.renderArrow&&this.$el.addClass("with-arrow"),"ours"==this.model.get("fault")&&this.$el.addClass("not-your-fault")},onShow:function(){if(this.options.targetEl){var e=$(this.options.targetEl),t=e.position(),i=t.top,o=t.left,n=(this.$el.outerWidth()-e.outerWidth())/2;this.$el.css({bottom:"auto",top:i-this.$el.height(),left:o,marginLeft:-1*n})}return this}}),StyleGallery.Views.UploadBarView=Marionette.Layout.extend({id:"gallery-upload-bar",className:"content-container",tagName:"footer",isTouch:!1,template:"gallery/upload_bar",events:{"click .fileinput-button":"trackDeviceUpload","click .no-user.fileinput-button":"redirectToLogin","click .instagram-button":"instagramIt"},regions:{errors:".errors"},cookiename:{ig:"sg.ig_msg"},hideExpandableContentOnRender:!0,initialize:function(){_.bindAll(this,"onUploadSuccess"),_.bindAll(this,"onUploadFailure"),_.bindAll(this,"clearInstagramError"),this.on("expandable:open",this.trackUploadIntent),this.on("expandable:open",this.trackUploadBarClosed),StyleGalleryBase.Views.ExpandableView.mixin(this)},serializeData:function(){return{formAction:router.paths.api.outfits(),galleryUploadPath:router.paths.galleryUpload(!0),hasUserClass:StyleGallery.currentUser?"":"no-user"}},onRender:function(){_dbg.log("[UploadBarView::render]")},onShow:function(){var e=this,t=this.$("form .fileinput-button");this.$("form").fileupload({dataType:"json",start:function(){e.setLoadingState(t),e.errors.close()},always:function(){e.clearLoadingState(t)},error:this.onUploadFailure,success:this.onUploadSuccess}),this.isInstagramUnavailableMode()&&(this.showInstagramError(),this.hideExpandableContentOnRender=!1),this.hideExpandableContentOnRender&&this.hideExpandableContent()},isInstagramUnavailableMode:function(){return!!$.cookie(this.cookiename.ig)},trackDeviceUpload:function(){mc_shared_assets.analytics.api.trackEvent("mobileDeviceUploadButtonClicked",{})},trackUploadBarClosed:function(){mc_shared_assets.analytics.api.trackEvent("mobileDeviceUploadBarClosed",{})},trackUploadIntent:function(){mc_shared_assets.analytics.api.trackEvent("mobileDeviceUploadIntent",{})},showInstagramError:function(){var e=$.cookie(this.cookiename.ig);this.errorView=new StyleGallery.Views.UploadBarErrorsView({model:new Backbone.Model({errors:[e],fault:"ours"}),targetEl:this.$(".instagram-button"),renderArrow:!0}),this.errors.show(this.errorView),setTimeout(this.clearInstagramError,6e3)},clearInstagramError:function(){$.removeCookie(this.cookiename.ig,{path:"/style-gallery"})},onUploadSuccess:function(e){this.outfitId=e.outfit.id,router.navigate(router.paths.outfitPreview(this.outfitId),{trigger:!0})},onUploadFailure:function(e){var t=JSON.parse(e.responseText).errors.image;this.errorView=new StyleGallery.Views.UploadBarErrorsView({model:new Backbone.Model({errors:t}),targetEl:this.$(".phone-button"),renderArrow:!0}),this.errors.show(this.errorView)},redirectToLogin:function(){return utils.redirectWhenSignedOut(),!1},instagramIt:function(){mc_shared_assets.analytics.api.trackEvent("mobileInstagramUploadButtonClicked",{}),this.instagramTokenPresent()?router.navigate(router.paths.galleryInstagramUpload(),{trigger:!0}):utils.returnableRedirect(window.router.paths.authenticate.instagram())},setLoadingState:function(e){e.addClass("loading").find("span").text("Loading...")},clearLoadingState:function(e){var t=e.data("button-text");e.removeClass("loading").find("span").text(t)},instagramTokenPresent:function(){return StyleGallery.currentUser&&!!StyleGallery.currentUser.get("instagram")&&""!==StyleGallery.currentUser.get("instagram").access_token}}),function(e){"use strict";StyleGallery.Views.PhotoGuidelinesView=StyleGalleryBase.Views.CarouselView.extend({isReadyForCarousel:!1,loop:!0,className:"photo-guidelines expandable-bar",carouselEl:function(){return this.$("ul")[0]},guidelines:["We love head-to-toe shots because they show us the outstanding outfits you put together.","We can’t accept any long distance, crowd, or overly blurry photos.","Photos need to be at least 462 px wide.",'We moderate all user-submitted photos and captions, so please keep in mind our <a href="http://www.modcloth.com/help/community_guidelines#photo-submission" target="_blank">guidelines</a> and <a href="http://www.modcloth.com/help/terms-of-use" target="_blank">Terms of Use</a>.',"Don’t forget to tell your friends and family to share your shots on their social networks!"],initialize:function(){this.collection=new Backbone.Collection(this.guidelines.map(function(e){return new Backbone.Model({value:e})})),this.listenTo(this,"show",this.onShow),this.listenTo(this,"expandable:open",this.onOpen),StyleGalleryBase.Views.ExpandableView.mixin(this),StyleGalleryBase.Views.CarouselView.prototype.initialize.apply(this,arguments)},render:function(){if(_dbg.log("[PhotoGuidelinesView::render]"),this.$el.is(":empty")){var e=HoganTemplates["shared/photo_guidelines"].render();this.$el.html(e)}},onShow:function(){this.collection.trigger("reset")},onOpen:function(){this.isReadyForCarousel=!0,this._swipeview||this.setupCarousel()},renderItem:function(t){return e("<li/>").append(e('<span class="guideline"></span>').html(t.get("value")))}})}(jQuery),function(e){"use strict";function t(){e(".right-filters li").removeClass("active"),e(".search-inputs li").addClass("active"),e(".search-inputs li").show(),e(".no-products-msg").hide(),e(".category-btn").hide()}var i;StyleGallery.Views.OutfitProductTaggerView=Backbone.Marionette.Layout.extend({className:"gallery-tag-products",viewName:"OutfitProductTagger",template:"upload/product_tagger",options:{mode:"tagger"},events:{"click .right-filters li":"browseModCloth","click .category-btn li":"browseCategory","click .collection-prev":"paginatePrev","click .collection-next":"paginateNext","click .no-order-history-msg-link":"orderHistoryRedirect","click .search-btn":"prepareSearch","click .search-inputs li":"prepareSearch","keypress .search-input-box":"onSearchboxKeypress","click .mobile-preview-cancel":"cancelPreview","click #mobile-fileupload .back-next-btn":"backButtonPressed","click .outfit-photo.admin":"openZoomWindow"},modelEvents:{change:"updateSubviews"},regions:{associatedProductsRegion:".carousel",catalogProductsRegion:".unselected-products ul",guidelinesRegion:".photo-guidelines"},initialize:function(){_.bindAll(this,"clearLoadingOverlay"),_.bindAll(this,"onUploadSuccess"),_.bindAll(this,"onUploadFailure")},serializeData:function(){return _.extend(this.model.toJSON(),{formAction:router.paths.api.outfits()})},onBeforeRender:function(){_dbg.log("[OutfitProductTagger] rendering..."),i=this,"preview"==this.options.mode&&(this.template="upload/outfit_preview"),this.route=utils.onAdminPath()?window.router.paths.admin.editOutfit(this.model.get("id")):this.isPreviewMode()?window.router.paths.outfitPreview(this.model.get("id")):window.router.paths.outfitProductTagger(this.model.get("id"))},onRender:function(){var e=this;this.$el.attr("class",function(t,i){return i.replace(/(^|\s)mode-\S*/,"")+" mode-"+e.options.mode});var t=!1;return this.model.hasChanged("id")||(t=!0),this.model.fetch({success:function(){t&&e.updateSubviews(),e.$(".outfit-photo img").on("load",e.clearLoadingOverlay)}}),this.$el.appendTo(".modal#uploadWizard"),utils.ensureMobileModalHeader(),this.showGuidelines(),this.updateLoadingSubview(),this.$("form").fileupload({dataType:"json",start:function(){e.model.loading=!0,e.updateLoadingSubview()},error:this.onUploadFailure,success:this.onUploadSuccess}),this},updateLoadingSubview:function(){this.model.loading?e(".loading-overlay").length||e('<div class="loading-overlay">Loading...</div>').cover(this.$(".outfit-photo img")):e(".loading-overlay").remove()},showGuidelines:function(){"preview"==this.options.mode&&(this.guidelinesView=new StyleGallery.Views.PhotoGuidelinesView,this.guidelinesRegion.show(this.guidelinesView))},syncCollections:function(){this.associatedProductsCollection=this.associatedProductsCollection||new StyleGallery.Collections.Products([],{url:window.router.paths.outfitAssignedProductsApi(this.model.get("id"))}),this.catalogProductsCollection=this.catalogProductsCollection||new StyleGallery.Collections.CatalogProducts},updateSubviews:function(){function e(){_dbg.log("[OutfitProductTagger :: Fetching associated products and ecomm products"),i.associatedProductsCollection.reset([],{silent:!0}),i.catalogProductsCollection.reset([],{silent:!0}),i.associatedProductsCollection.url=window.router.paths.outfitAssignedProductsApi(i.model.get("id")),i.catalogProductsCollection.userId=i.model.get("contributor").id,i.catalogProductsCollection.goTo(1);var e=new StyleGallery.Views.AssociatedProductsView({collection:i.associatedProductsCollection,outfitId:i.model.get("id")}),t=new StyleGallery.Views.CatalogProductsView({collection:i.catalogProductsCollection,associatedProductsCollection:i.associatedProductsCollection});i.associatedProductsCollection.fetch({reset:!0}).done(function(){_dbg.log("[OutfitProductTaggerView] successfully fetched associated products"),_dbg.log("  ** from: "+i.associatedProductsCollection.url),i.associatedProductsRegion.show(e),i.catalogProductsRegion.show(t),i.catalogProductsCollection.fetch().done(function(){_dbg.log("[OutfitProductTaggerView] successfully fetched catalog products"),_dbg.log("  ** from: "+i.catalogProductsCollection.paginator_core.url())})})}function t(){utils.onAdminPath()&&i.$(".outfit-photo").addClass("admin"),i.$(".outfit-photo img").attr("src",i.model.get("images").medium.url)}var i=this;return utils.onAdminPath()||this.model.getUserUploaded()?(this.syncCollections(),e(),t(),void 0):(utils.redirect(window.router.paths.gallery(null,!0)),void 0)},browseModCloth:function(t){t.preventDefault(),e(".no-products-msg").hide(),e(".active",".gallery-tag-products").removeClass("active"),e(t.target).addClass("active"),e(".search-word-btn").hide(),e(".category-btn").show();var o=i.catalogProductsCollection;"order-history"==e(t.target).data().source&&e(".category-btn").hide(),o.slug=e(t.target).data().source,o.goTo(1),e('.category-btn li[data-slug="'+o.slug+'"]').addClass("active")},browseCategory:function(t){i.catalogProductsCollection.slug=e(t.target).data("slug"),i.catalogProductsCollection.goTo(1),e("ul.category-btn li").each(function(){e(this).removeClass("active")}),e(t.target).addClass("active")},orderHistoryRedirect:function(t){t.preventDefault(),e(".no-products-msg").hide(),e(".right-filters .active").removeClass("active"),e('.right-filters li[data-source="clothing"]').addClass("active"),e(".category-btn").show();var o=i.catalogProductsCollection;o.slug="clothing",o.goTo(1)},paginatePrev:function(e){e.stopPropagation(),e.preventDefault(),i.catalogProductsCollection.requestPreviousPage()},paginateNext:function(e){e.stopPropagation(),e.preventDefault(),i.catalogProductsCollection.requestNextPage()},onSearchboxKeypress:function(e){13==e.which&&this.prepareSearch()},prepareSearch:function(){var i=e("input#search").val();t(i),this.search(i)},search:function(e){this.catalogProductsCollection.url=window.router.paths.productsBySearchTerm(e),this.catalogProductsCollection.slug="perform-search",this.catalogProductsCollection.goTo(1)},viewWillRender:function(e){e=_.extend({mode:"tagger"},e),this.options.mode=e.mode,this.model.set({id:e.outfitId},{silent:!0})},viewWillExit:function(){this.catalogProductsCollection.setDefaultSlug()},isPreviewMode:function(){return"preview"==this.options.mode},cancelPreview:function(){this.isPreviewMode()&&(this.destroyOutfit(),window.currentWizard.close())},destroyOutfit:function(){this.model.destroy()},onUploadSuccess:function(e){this.destroyOutfit(),this.outfitId=e.outfit.id,router.navigate(router.paths.outfitPreview(this.outfitId),{trigger:!0})},onUploadFailure:function(e){this.errors=JSON.parse(e.responseText).errors.image,this.errorView=new StyleGallery.Views.UploadBarErrorsView({errors:this.errors}),this.$(".outfit-photo").append(this.errorView.render().el),this.clearLoadingOverlay(),this.$(".mobile-preview-submit").attr("disabled","disabled"),this.$(".outfit-photo img").hide(),this.$el.addClass("has-errors")},onClose:function(){this.cancelPreview(),this.errorView&&this.errorView.close()},clearLoadingOverlay:function(){this.model.loading=!1,this.updateLoadingSubview()},backButtonPressed:function(){this.$(".mobile-preview-submit").removeAttr("disabled"),this.errorView&&this.errorView.close(),this.$el.removeClass("has-errors")},openZoomWindow:function(){event.preventDefault(),event.stopPropagation(),window.open(this.model.get("image_url"),"Outfit-"+this.model.get(""),"height=500,width=350,menubar=no,status=no")}})}(jQuery),function(){"use strict";StyleGallery.Views.AssociatedProductView=Backbone.View.extend({events:{"click .remove-item":"handleClick"},tagName:"li",className:"product-browser-associated-product",attributes:function(){var e={};return e["data-id"]=this.model.get("id"),e},initialize:function(){_.bindAll(this,"renderTooltip"),this.model.set({faded:!1},{silent:!0})},render:function(){_dbg.log("[AssociatedProduct] rendering...");var e=_.template("<a href='#' class='assign-product-link'><img src='{{ image }}' alt='Unselected Product Picture {{ id }}' /></a><span class='remove-item'></span><div class='toggle'></div>");
this.$el.html(e(this.model.toJSON()));var t=!0;return this.model.has("pictured")&&(t=this.model.get("pictured")),$(".toggle",this.$el).toggles({ontext:"Pictured",offtext:"Similar",on:t}),$(".toggle",this.$el).on("click",function(e){e.stopPropagation()}),this.$toggle=this.$toggle||this.$(".toggle"),_e.off("toggle:done",this.handleToggle),_e.on("toggle:done",this.handleToggle,this),this.options.tooltip&&setTimeout(this.renderTooltip,0),this},renderTooltip:function(){this.$toggle.tooltip({title:"Is this item <b>pictured in your look</b> or is it <b>similar to your look</b>?<span class='tooltip-close'>x</span>",placement:"top",html:!0,trigger:"manual",container:this.$el.closest(".modal")}),this.$el.closest(".modal").on("click",".tooltip-close",this.closeTooltip),this.$toggle.tooltip("show")},closeTooltip:function(e){$(e.currentTarget).closest(".tooltip").remove()},handleToggle:function(){this.$toggle.tooltip("destroy")},handleClick:function(){_e.trigger("outfit-product-tagger:associated-product:click",this.model.get("id"))}})}(),function(){"use strict";var e;StyleGallery.Views.AssociatedProductsView=StyleGalleryBase.Views.CarouselView.extend({tagName:"ul",pageSize:4,isReadyForCarousel:!1,wasEmptyWhenPristine:!1,tooltipActive:!1,events:{"mousedown img":function(e){e.preventDefault()}},initialize:function(){this.listenTo(this.collection,"reset",this.onChange),this.listenTo(this.collection,"add",this.onChange),this.listenTo(this.collection,"remove",this.onChange),_e.off("outfit-product-tagger:catalog-product:click",this.addProduct),_e.on("outfit-product-tagger:catalog-product:click",this.addProduct,this),_e.off("outfit-product-tagger:associated-product:click",this.removeProduct),_e.on("outfit-product-tagger:associated-product:click",this.removeProduct,this),_e.off("toggle:done",this.submitPicturedOrInspiredBy),_e.on("toggle:done",this.submitPicturedOrInspiredBy,this),this.listenTo(this,"carousel-view:change",this.showOrHideNavigation),this.listenTo(this,"show",this.onShow),StyleGalleryBase.Views.CarouselView.prototype.initialize.apply(this,arguments)},render:function(){return _dbg.log("[AssociatedProductsView::render]"),this.setOutfitProductTagger(),this.collection.isEmpty()||(this.isReadyForCarousel=!0),this},onShow:function(){this.$el.is(":empty")&&this.setupCarousel(),this.collection.isEmpty()||this.showOrHideNavigation()},onChange:function(){var e=$(".gallery-tag-products");this.tooltipActive=this.wasEmptyWhenPristine&&1==this.collection.modificationCount,this.collection.isEmpty()?(this.collection.pristine&&(this.wasEmptyWhenPristine=!0),e.removeClass("has-products"),$(".back-next-btn.next-button").html('Skip <span class="nav-icon">&raquo;</span>')):(this.$el.closest("body").length&&(this.isReadyForCarousel=!0),e.addClass("has-products"),$(".back-next-btn.next-button").html('Done <span class="nav-icon">&raquo;</span>')),this.removeTooltips()},renderItem:function(e,t){var i=new StyleGallery.Views.AssociatedProductView({model:e,tooltip:this.tooltipActive&&0==t});return i.render().el},removeTooltips:function(){this.$el.closest(".modal").find(".tooltip").remove()},addProduct:function(t){var i,o=this;_.isNumber(t)&&(i=new StyleGallery.Models.Product({id:t}),i.fetch({success:function(){o.collection.add(i),e.model.addProduct(i)}}))},removeProduct:function(t){var i=this,o=this.collection.get(t);i.collection.remove(o),e.model.removeProduct(o)},updatePicturedOrInspiredBy:function(e,t){var i=this.collection.get(e);i&&i.set({pictured:t},{silent:!0})},setOutfitProductTagger:function(){e=window.currentWizard.stepForStepName("OutfitProductTagger")},showOrHideNavigation:function(){var e=$(".gallery-tag-products");e.removeClass("last-page"),e.removeClass("first-page"),this.isFirstPage()&&e.addClass("first-page"),this.isLastPage()&&e.addClass("last-page")},submitPicturedOrInspiredBy:function(t,i){var o=this,n=$(t).parents("li").data("id"),a=e.model.get("id"),s=this.collection.get(n);o.updatePicturedOrInspiredBy(n,i),s.whenUnlocked(function(){$.ajax({type:"PUT",data:{active:i},url:window.router.paths.outfitUpdatePicturedProduct(a,n)})})}})}(),function(){"use strict";StyleGallery.Views.CatalogProductView=Backbone.Marionette.ItemView.extend({tagName:"li",className:"product-browser-catalog-product",template:"upload/catalog_product",events:{click:"handleClick"},modelEvents:{change:"render"},attributes:function(){var e={};return e["data-id"]=this.model.get("id"),e},serializeData:function(){return this.archived="archived"==this.model.get("state"),this.image="http://"+this.model.get("image_url"),$.extend({archived:this.archived,image:this.image},this.model.toJSON())},onRender:function(){_dbg.log("[CatalogProductView::render]"),this.$("img").error(function(){$(this).hide()}),this.archived&&this.$el.addClass("archived"),this.model.get("faded")&&this.$el.addClass("faded")},fade:function(){this.model.set({faded:!0}),this.$el.addClass("faded")},unfade:function(){this.model.set({faded:!1}),this.$el.removeClass("faded")},handleClick:function(e){e.preventDefault(),this.archived||(_e.trigger("outfit-product-tagger:catalog-product:click",this.model.get("id")),this.fade())}})}(),function(){"use strict";StyleGallery.Views.CatalogProductsView=Backbone.Marionette.CollectionView.extend({itemView:StyleGallery.Views.CatalogProductView,collectionEvents:{"change:done":"manageNextPrevButtons"},initialize:function(){_dbg.log("[CatalogProductsView::initialize]"),_e.on("outfit-product-tagger:associated-product:click",this.unfadeProduct,this)},onBeforeRender:function(){if(this.collection.length){var e=this.options.associatedProductsCollection.pluck("id");this.collection.chain().filter(function(t){return _.include(e,t.get("id"))}).invoke("fade")}},onRender:function(){_dbg.log("[CatalogProductsView::render]"),0==this.collection.length&&1==this.collection.currentPage&&this.showErrorMessage(this.collection.slug)},unfadeProduct:function(e){var t=this.children.find(function(t){return t.model.get("id")==e});t&&t.unfade()},showErrorMessage:function(e){if("order-history"==e)$(".no-products-msg").html('You haven’t ordered from us yet, have you? No worries! You can still add similar items inspired by your look, too. Just use the Search box, or <a class="no-order-history-msg-link" href="#">Browse ModCloth!</a>').show();else if("perform-search"==e){var t=$("input#search").val();$(".no-products-msg").html('Sorry, no results found for "'+t+'". Please try another search.').show()}},manageNextPrevButtons:function(){var e=this.collection,t=!0,i=!0;1==e.currentPage&&(i=!1),(e.length<e.perPage||0==e.length)&&(t=!1),$("a.collection-next").toggle(t),$("a.collection-prev").toggle(i)}})}(),function(e){"use strict";StyleGallery.Views.OutfitProductSubmitterView=Backbone.Marionette.ItemView.extend({className:"gallery-tag-products-submitter",viewName:"OutfitProductSubmitter",template:"upload/confirmation",modelEvents:{change:"submitPhoto render"},initialize:function(){e(window).width()<1025&&(this.template="upload/confirmation_mobile")},serializeData:function(){var e="https://www.modcloth.com/customers/accounts/"+StyleGallery.currentUser.get("id")+"/edit",t=window.router.paths.gallery("",!0);return _.extend(this.model.toJSON(),{editAccountURL:e,galleryURL:t})},onRender:function(){return _dbg.log("[OutfitProductSubmitterView] rendering..."),this.$el.appendTo(".modal#uploadWizard"),utils.ensureMobileModalHeader(),this.route=window.router.paths.submitOutfit(this.model.get("id")),setTimeout(function(){e("#close-hi-five").click()},2e4),this},submitPhoto:function(){this.model.save({state:"pending"},{})},viewWillRender:function(e){this.model.set({id:e.outfitId},{silent:!0}),this.model.fetch()}})}(jQuery),window.StyleGallery.Views.OutfitView=Backbone.Marionette.Layout.extend({className:"outfit",events:{"click .gallery-overlay-trigger":"showDetailView","click .touch-share-trigger":"toggleSharingWidget","click .meta-bar":"dismissSharingWidget"},defaults:function(){return{imageDimensions:{width:320,height:0}}},regions:{loveButton:".bb-love-button",shareWidget:".share-widget-container"},templateHelpers:{moderatedAtTimeAgo:function(){return this.moderated_at?moment(this.moderated_at).fromNow():"Recently"}},template:"gallery/outfit",attributes:function(){var e={},t=this.model.get("id");return e.id="image-"+t,e["data-id"]=t,e["data-page"]=this.options.page,e["data-height"]=this.model.get("images").medium.height,e["data-width"]=this.model.get("images").medium.width,e},initialize:function(){_dbg.log("[OutfitView::initialize]"),_.bindAll(this,"showDetailView"),this.options=_.defaults(this.options,this.defaults()),this.loveButtonView=this.options.loveButtonView||new StyleGallery.Views.LoveButtonView({model:this.model}),this.sharingWidgetView=this.options.sharingWidgetView||new StyleGallery.Views.SocialSharingWidget({model:this.model})},onRender:function(){this._setImageDimensions(),this.loveButton.show(this.loveButtonView),this.shareWidget.show(this.sharingWidgetView)},showDetailView:function(e){e&&e.preventDefault(),mc_shared_assets.analytics.api.pushContext({outfitId:this.model.get("id")}),mc_shared_assets.analytics.api.trackEvent("outfitDetailViewClick",{}),window.router.navigate(window.router.paths.galleryOutfit(this.model.get("id")),{trigger:!0})},toggleSharingWidget:function(){var e,t;return e=this.$el.find(".share-widget"),t=e.is(":visible"),this.dismissSharingWidget(),e.parent().toggle(!t),!1},dismissSharingWidget:function(){Modernizr.touch&&$(".share-widget-container").hide()},setPositionAndScaleFactor:function(e,t,i){this._setPosition(e,t),this._setScaleFactor(i),this._setImageUrl(),this.$el.show()},getHeight:function(){return this.$el.outerHeight()},_setScaleFactor:function(e){var t=this.options.imageDimensions;t.width=Math.floor(this.model.get("images").medium.width*e),t.height=Math.floor(this.model.get("images").medium.height*e),this._setImageDimensions()},_setImageDimensions:function(){this.$el.find(".outfit-image").css({width:this.options.imageDimensions.width+"px",height:this.options.imageDimensions.height+"px"}),this.$el.find(".meta-bar").css({width:this.options.imageDimensions.width-10+"px"})},_setImageUrl:function(){var e=this.model.get("images").medium.url;this.$el.find("img.outfit-image").attr("src",e)},_setPosition:function(e,t){this.$el.css({top:e,left:t})}}),StyleGallery.Views.OutfitsView=Backbone.View.extend({initialize:function(){this.callbacksOn=!1,_.bindAll(this,"_renderIfNewFilter","_handleScrollToBottom","_turnOffCallbacks","_turnOnCallbacks"),_e.off("outfitDetail:didRender",this._hideShareWidgets),_e.on("outfitDetail:didRender",this._hideShareWidgets,this),_e.off("outfitDetail:didRender",this._turnOffCallbacks),_e.on("outfitDetail:didRender",this._turnOffCallbacks,this),_e.off("outfitDetail:didClose",this._handleContainerWidthChange),_e.on("outfitDetail:didClose",this._handleContainerWidthChange,this),_e.off("outfitDetail:didClose",this._turnOnCallbacks),_e.on("outfitDetail:didClose",this._turnOnCallbacks,this),this._turnOffCallbacks(),this._turnOnCallbacks(),this.listenTo(this.collection,"change:done",this.render),this.listenTo(this.collection,"reset",this.render),this._layout=this._createOutfitsLayout(),this.listenTo(this._layout,"change:height",this._handleLayoutHeightChange),this.AllOutfits=new StyleGallery.Collections.Outfits},fetchOutfits:function(){0===this.collection.length?this.collection.fetch():initialBackboneData.resourceIdentifier||this._renderIfNewFilter()},render:function(){if(0===this.collection.length&&this.emptyView){var e=new this.emptyView({collection:this.collection});this.$el.html(e.render().el)}else{_dbg.log("[OutfitCollectionView::render]"),this._showLoadingMessage();var t=this.collection.map(this._renderOutfit,this);this._layout.flowOutfits(t,1===this.collection.currentPage),$(window).data("scrollAjaxReady",!0),mc_shared_assets.analytics.api.pushContext({currentView:"outfitCollectionView"}),this.collection.isLastPage()&&this._hideLoadingMessage()}return this},destroy:function(){_e.off("outfitDetail:didRender",this._hideShareWidgets),_e.off("outfitDetail:didRender",this._turnOffCallbacks),_e.off("outfitDetail:didClose",this._handleContainerWidthChange),_e.off("outfitDetail:didClose",this._turnOnCallbacks),this.stopListening()},_renderOutfit:function(e){var t=this._createOutfitView({model:e,page:this.collection.currentPage});return this.$el.append(t.render().el),this.AllOutfits.push(e),t},_turnOffCallbacks:function(){_e.off("scroll:bottom",this._handleScrollToBottom),_e.off("window:resize",this._handleContainerWidthChange),_e.off("orientationDidChange",this._handleContainerWidthChange),this.callbacksOn=!1},_turnOnCallbacks:function(){this.callbacksOn===!1&&(_e.on("scroll:bottom",this._handleScrollToBottom,this),_e.on("window:resize",this._handleContainerWidthChange,this),_e.on("orientationDidChange",this._handleContainerWidthChange,this),this.callbacksOn=!0)},_handleLayoutHeightChange:function(e,t){this.$el.css("height",t+"px")},_handleContainerWidthChange:function(){this._layout.set("containerWidth",this._getContainerWidth())},_getContainerWidth:function(){return this.$el.width()},_createOutfitView:function(e){return new StyleGallery.Views.OutfitView(e)},_createOutfitsLayout:function(){var e={containerWidth:this._getContainerWidth()};return this.options.layout||new StyleGallery.Models.OutfitsLayout(e)},_hideLoadingMessage:function(){$(".spindicator").hide()},_showLoadingMessage:function(){$(".spindicator").show()},_renderIfNewFilter:function(){var e="undefined"==typeof this.collection.activeScope,t=this.collection.activeScope!==this.collection.selectedScope,i=this.collection.activeFilter!==this.collection.selectedFilter;(e||t||i)&&(this.$el.find(".outfit").remove(),this.stopListening(this._layout,"change:height",this._handleLayoutHeightChange),this._layout=this._createOutfitsLayout(),this.listenTo(this._layout,"change:height",this._handleLayoutHeightChange),this.collection.currentPage=1,this.collection.fetch())},_handleScrollToBottom:function(){this.collection.length>0&&!this.collection.isLastPage()&&this.collection.requestNextPage()},_hideShareWidgets:function(){Modernizr.touch&&$(".share-widget-container").hide()}}),StyleGallery.Controllers.ActionBarController=Marionette.Controller.extend({follow:function(){_dbg.log("ActionBarController::follow");var e=window.features&&features.follow;return e?(StyleGallery.followBarView=new StyleGallery.Views.FollowBarView({model:StyleGallery.currentProfile}),this.options.region.show(StyleGallery.followBarView),void 0):this.upload()},upload:function(){_dbg.log("ActionBarController::upload"),StyleGallery.uploadBarView=StyleGallery.uploadBarView||new StyleGallery.Views.UploadBarView,this.options.region.show(StyleGallery.uploadBarView)}}),StyleGallery.Modules.ActionBarModule={startWithParent:!1,define:function(){this.router={routes:function(){var e={};return StyleGallery.currentUser&&(e["^users/"+StyleGallery.currentUser.id]="upload"),e["^users/(\\d)"]="follow",e[".*"]="upload",e},onPageView:function(){var e=this,t=Backbone.history.getFragment();_.any(_.result(this.router,"routes"),function(i,o){var n=new RegExp(o).exec(t);return n?(e.controller[i].apply(e.controller,n.slice(1)),!0):void 0})}},this.on("start",function(e){this.region=e,this.controller=new StyleGallery.Controllers.ActionBarController({region:e}),this.app.vent.on("pageview",_.bind(this.router.onPageView,this))})}},StyleGallery.Controllers.BannerController=Marionette.Controller.extend({followableUserCollection:function(){return window.features&&features.follow?(_dbg.log("BannerController::followableUserCollection"),this.options.region.show(this.options.layout),this.options.layout.$el.addClass("followable"),this.options.layout.title.show(new StyleGallery.Views.TitleBannerView),this.options.layout.subtitle.show(new StyleGallery.Views.SubtitleTagView),this.options.layout.button.show(new StyleGallery.Views.TitleFollowButtonView),window.features&&features.follow&&this.options.layout.relationships.show(new StyleGallery.Views.FollowHeader({parentEl:this.options.layout.subtitle.el})),void 0):this.nonFollowableUserCollection()},nonFollowableUserCollection:function(){_dbg.log("BannerController::nonFollowableUserCollection"),this.options.region.show(this.options.layout),this.options.layout.title.show(new StyleGallery.Views.TitleBannerView),this.options.layout.subtitle.show(new StyleGallery.Views.SubtitleTagView),this.options.layout.button.show(new StyleGallery.Views.TitleButtonView),window.features&&features.follow&&this.options.layout.relationships.show(new StyleGallery.Views.FollowHeader({parentEl:this.options.layout.subtitle.el}))},gallery:function(){_dbg.log("BannerController::gallery"),this.options.region.show(this.options.layout),this.options.layout.title.show(new StyleGallery.Views.TitleBannerView),this.options.layout.subtitle.show(new StyleGallery.Views.SubtitleBaseView),this.options.layout.button.show(new StyleGallery.Views.TitleButtonView)},tagsCollection:function(){_dbg.log("BannerController::tagsCollection"),this.options.region.show(this.options.layout),this.options.layout.title.show(new StyleGallery.Views.TitleBannerView),this.options.layout.subtitle.show(new StyleGallery.Views.SubtitleTagView),this.options.layout.button.show(new StyleGallery.Views.TitleButtonView)}}),StyleGallery.Modules.BannerModule={startWithParent:!1,define:function(){this.router={routes:function(){var e={};return StyleGallery.currentUser&&(e["^users/"+StyleGallery.currentUser.id]="nonFollowableUserCollection"),e["^users/(\\d+)"]="followableUserCollection",e["^$"]="gallery",e["^loved"]="gallery",e["^loved/(.*)"]="gallery",e["^latest"]="gallery",e["^latest/(.*)"]="gallery",e["^featured"]="gallery",e["(.*)"]="tagsCollection",e},onPageView:function(){var e=this,t=Backbone.history.getFragment();_.any(_.result(this.router,"routes"),function(i,o){var n=new RegExp(o).exec(t);return n?(e.controller[i].apply(e.controller,n.slice(1)),!0):void 0})}},this.on("start",function(e){this.region=e,this.layout=new StyleGallery.Views.BannerLayout,this.controller=new StyleGallery.Controllers.BannerController({region:e,layout:this.layout}),this.app.vent.on("pageview",_.bind(this.router.onPageView,this))})}},StyleGallery.Views.BannerLayout=Backbone.Marionette.Layout.extend({template:"gallery/banner_layout",regionType:StyleGallery.FlatRegion,regions:{button:".title-button",title:".title",subtitle:".subtitle",relationships:".relationships"}}),GalleryController=Backbone.Marionette.Controller.extend({gallery:function(){_dbg.log("[Router::gallery]"),utils.pageViewDidHappen({page_name:"modcloth>style-gallery"});var e=new StyleGallery.Collections.PaginatedOutfits,t={collection:e,el:$(".outfits")};this._withinGalleryLayout(function(){StyleGallery.outfitCollectionView=window.StyleGallery.outfitCollectionView||new StyleGallery.Views.OutfitsView(t),StyleGallery.scopeView=StyleGallery.scopeView||new StyleGallery.Views.ScopeView(window.initialBackboneData.validScopes),StyleGallery.scopeView.registerPaginator(StyleGallery.outfitCollectionView.collection),StyleGallery.scopeView.render()}),StyleGallery.outfitCollectionView.fetchOutfits(),StyleGallery.outfitDetailView&&StyleGallery.outfitDetailView.close(),GalleryApplication.vent.trigger("pageview")},tagsCollection:function(e){_dbg.log("[Router::outfitsCollection]"),utils.pageViewDidHappen({page_name:"modcloth>style-gallery>"+e}),StyleGallery.rootCollectionUrl=e,this.renderViewForCollection(new StyleGallery.Collections.PaginatedOutfitsByTag,{showSliver:!1}),GalleryApplication.vent.trigger("pageview")},renderViewForCollection:function(e,t){var i={collection:e,el:$(".outfits")};StyleGallery.outfitCollectionView=StyleGallery.outfitCollectionView||new StyleGallery.Views.OutfitsView(i),this._withinGalleryLayout(null,t),StyleGallery.outfitCollectionView.fetchOutfits(),StyleGallery.outfitDetailView&&StyleGallery.outfitDetailView.close()},_withinGalleryLayout:function(e,t){var t=_.defaults(t||{},{showSliver:!0});StyleGallery.titleBannerView||(StyleGallery.titleBannerView=new StyleGallery.Views.TitleBannerView,StyleGallery.titleBannerView.render()),StyleGallery.sliverView||(StyleGallery.sliverView=new StyleGallery.Views.SliverView,StyleGallery.sliverView.render()),e&&e()},galleryUpload:function(){_dbg.log("[Router::galleryUpload]"),utils.pageViewDidHappen(),StyleGallery.currentUser?(currentWizard.setCurrentStep("Upload"),currentWizard.render()):utils.redirect(router.paths.signIn()),GalleryApplication.vent.trigger("pageview")},galleryInstagramUpload:function(){_dbg.log("[Router::galleryInstagramUpload]"),utils.pageViewDidHappen(),StyleGallery.currentUser?(_.extend(currentWizard.data,{mode:"instagram"}),currentWizard.setCurrentStep("Upload"),currentWizard.render()):utils.redirect(router.paths.signIn()),GalleryApplication.vent.trigger("pageview")},outfitPreview:function(e){mc_shared_assets.analytics.api.trackEvent("pageView"),_dbg.log("[Router::outfitPreview]"),utils.redirectWhenSignedOut(),StyleGallery.scopeView=StyleGallery.scopeView||new StyleGallery.Views.ScopeView(window.initialBackboneData.validScopes),_.extend(currentWizard.data,{outfitId:e,mode:"preview"}),currentWizard.setCurrentStep("OutfitProductTagger"),currentWizard.render(),GalleryApplication.vent.trigger("pageview")},outfitProductTagger:function(e){return _dbg.log("[Router::outfitProductTagger]"),utils.pageViewDidHappen(),window.StyleGallery.currentUser?(utils.redirectWhenSignedOut(),StyleGallery.scopeView=StyleGallery.scopeView||new StyleGallery.Views.ScopeView(window.initialBackboneData.validScopes),_.extend(currentWizard.data,{outfitId:e,mode:"tagger"}),currentWizard.setCurrentStep("OutfitProductTagger"),currentWizard.render(),GalleryApplication.vent.trigger("pageview"),void 0):(utils.redirect(router.paths.signIn()),void 0)},outfit:function(e){_dbg.log("[Router::outfitView]"),utils.pageViewDidHappen({page_name:"modcloth>style-gallery>outfit>"+e,outfitId:e}),mc_shared_assets.analytics.api.trackEvent("outfitDetailView"),window.StyleGallery.outfitDetailView=new StyleGallery.Views.OutfitDetailView({model:new StyleGallery.Models.Outfit}),"undefined"==typeof StyleGallery.scopeView&&(StyleGallery.scopeView=new StyleGallery.Views.ScopeView(window.initialBackboneData.validScopes));var t={collection:new StyleGallery.Collections.PaginatedOutfits,el:$(".outfits")};"undefined"==typeof window.StyleGallery.outfitCollectionView&&(window.StyleGallery.outfitCollectionView=new StyleGallery.Views.OutfitsView(t));var i,o;"undefined"!=typeof StyleGallery.outfitCollectionView&&(o=StyleGallery.outfitCollectionView.collection.get(e)),o||(o=new StyleGallery.Models.Outfit({id:e}),i=!0),StyleGallery.outfitDetailView=new StyleGallery.Views.OutfitDetailView({model:o}),i?StyleGallery.outfitDetailView.model.fetch():StyleGallery.outfitDetailView.render(),GalleryApplication.vent.trigger("pageview")},submitOutfit:function(e){_dbg.log("[Router::submitOutfit]"),utils.pageViewDidHappen(),currentWizard.data.outfitId=e,currentWizard.setCurrentStep("OutfitProductSubmitter"),currentWizard.render(),GalleryApplication.vent.trigger("pageview")},setCurrentProfile:function(e){StyleGallery.currentProfile=new StyleGallery.Models.Profile({account_id:e.id}),StyleGallery.currentProfile.fetch()}}),GalleryRouter=Backbone.Marionette.AppRouter.extend({appRoutes:{"style-gallery":"gallery","":"gallery",latest:"gallery","latest/:filter":"gallery",loved:"gallery","loved/:filter":"gallery",featured:"gallery",upload_photo:"galleryUpload","instagram/upload_photo":"galleryInstagramUpload","outfit/:id/preview":"outfitPreview","outfit/:id/assign_products":"outfitProductTagger","outfit/:id/submit":"submitOutfit","outfits/:id":"outfit",":slug":"tagsCollection"},initialize:function(e){this.options=e||{},StyleGalleryBase.Routers.Paths.mixin(this),StyleGalleryBase.Routers.TrailingSlash.mixin(this)}}),GalleryApplication=new Backbone.Marionette.Application,GalleryApplication.addInitializer(function(){window.controller=new GalleryController,window.router=new GalleryRouter({controller:window.controller}),this.module("Banner").start(this.headerRegion),this.module("ActionBar").start(this.actionRegion),utils.startBackboneHistory()}),GalleryApplication.addRegions({headerRegion:"#style-gallery-banner",contentRegion:"#gallery",actionRegion:"#fixed"}),GalleryApplication.module("Banner",StyleGallery.Modules.BannerModule),GalleryApplication.module("ActionBar",StyleGallery.Modules.ActionBarModule),$(function(){_dbg.log("[:: Launching Style Gallery App]"),StyleGallery.Initializers.styleGalleryApp(),window.app=GalleryApplication}),function(e,t,i){function o(){n=t[r](function(){a.each(function(){var t=e(this),i=t.width(),o=t.height(),n=e.data(this,c);(i!==n.w||o!==n.h)&&t.trigger(l,[n.w=i,n.h=o])}),o()},s[d])}var n,a=e([]),s=e.resize=e.extend(e.resize,{}),r="setTimeout",l="resize",c=l+"-special-event",d="delay",u="throttleWindow";s[d]=250,s[u]=!0,e.event.special[l]={setup:function(){if(!s[u]&&this[r])return!1;var t=e(this);a=a.add(t),e.data(this,c,{w:t.width(),h:t.height()}),1===a.length&&o()},teardown:function(){if(!s[u]&&this[r])return!1;var t=e(this);a=a.not(t),t.removeData(c),a.length||clearTimeout(n)},add:function(t){function o(t,o,a){var s=e(this),r=e.data(this,c);r.w=o!==i?o:s.width(),r.h=a!==i?a:s.height(),n.apply(this,arguments)}if(!s[u]&&this[r])return!1;var n;return e.isFunction(t)?(n=t,o):(n=t.handler,t.handler=o,void 0)}}}(jQuery,this),mc_shared_assets.scope("mc_shared_assets.social_sharing.product",function(e){function t(e){for(var t={},i=e.attributes||[],o=0;o<i.length;o++){var n=/data\-(.*)/.exec(i[o].name);n&&(t[n[1].replace(/\-/g,"_")]=i[o].value)}return t}if(e.create=function(e,t){function i(e){var t=e.toLowerCase(),i=$("<a></a>").text(e).attr("href","#").addClass("social-sharing icon-24 "+t);return i.click(function(i){return i.stopImmediatePropagation(),mc_shared_assets.trigger("trackEvent","social-share-"+t,h.getContext()),h["shareOn"+e].call(h),!1}),i}function o(e){var t=h.getContext().product_url||document.location.href;return t+=(/\?/.exec(t)?"&":"?")+h.campaignParamsURIEncoded(e)}function n(){return h.getContext().product_name}function a(){return h.getContext().product_summary}function s(){return h.getContext().product_image_url}function r(){return h.getContext().redirect_url}function l(){return h.getContext().pin||n()}function c(){return h.getContext().facebook_title||n()}function d(){var e=h.getContext().tweet||"My heart skips a beat for the "+n()+" that I found via @ModCloth! ";return e+=o("twitter")}function u(){return"phone"==h.getContext().device_type}var h={contextFn:null};return h.initialize=function(){h.$el=$("<div></div>").addClass("social-sharing-product").data("view",h);for(var t=0;t<e.length;t++)h.$el.append(i(e[t]));return h},h.getContext=function(){var e=t||{};return h.contextFn&&$.extend(e,h.contextFn()),e},h.shareOnTwitter=function(){window.open("http://twitter.com/home?status="+encodeURIComponent(d()),"_share_twitter","height=400, width=700")},h.shareOnFacebook=function(){var e="link="+encodeURIComponent(o("facebook"))+"&name="+encodeURIComponent(c());e+="&app_id=235443466567312",e+="&redirect_uri="+encodeURIComponent(r()),e+="&description="+encodeURIComponent(a()),e+="&picture="+encodeURIComponent(s()),u()?h.facebookSharingRedirect("http://m.facebook.com/dialog/feed?",e):h.facebookSharingRedirect("http://www.facebook.com/dialog/feed?",e)},h.shareOnPinterest=function(){window.open("http://pinterest.com/pin/create/button/?url="+encodeURIComponent(o("pinterest"))+"&media="+encodeURIComponent(s())+"&description="+encodeURIComponent(l()),"_share_pinterest","height=320, width=600")},h.shareOnEmail=function(){$cache.emailModal.find("form").get(0).reset(),$cache.emailMessage.val("Check out what I found at ModCloth!"),$cache.emailErrors.empty(),$cache.sharePanel.show(),$cache.emailModal.find(".success-panel").hide()},h.showEmailShareSuccess=function(e){$cache.successPanel.find(".modal-directions").text("An email has been sent to "+e.to_email+" about the "+e.product_name+"."),$cache.successPanel.show(),$cache.emailModal.find(".share-panel").hide()},h.campaignParamsURIEncoded=function(e){var t=h.getContext().ga_utm_medium||"",i=h.getContext().ga_utm_campaign||"",o=h.getContext().ga_utm_keyword||"";return"utm_source="+e+"&utm_medium="+t+"&utm_campaign="+i+"&utm_keyword="+o},h.facebookSharingRedirect=function(e,t){window.location.replace(e+t)},h.initialize()},e.gaEventBuilder=function(e,t){switch(e){case"social-share-facebook":return["social_network_share",t.ga_category_prefix?t.ga_category_prefix+":facebook":"Facebook",t.product_id];case"social-share-twitter":return["social_network_share",t.ga_category_prefix?t.ga_category_prefix+":twitter":"Twitter",t.product_id];case"social-share-pinterest":return["social_network_share",t.ga_category_prefix?t.ga_category_prefix+":pinterest":"Pinterest",t.product_id];case"social-share-email":return["social_network_share",t.ga_category_prefix?t.ga_category_prefix+":email":"Tell-a-Friend",t.product_id]}},e.omnitureEventBuilder=function(e,t){var i={facebook:"Facebook",twitter:"Twitter",pinterest:"Pinterest",email:"Tell-a-Friend"},o=/social-share-(.*)/.exec(t.event);o&&i[o[1]]&&(e.linkName=e.eVar26=e.prop26="modcloth>share>"+i[o[1]],e.events="event11,event80",e.products=""+t.inventory_classification_id+";"+t.product_id)},"undefined"==typeof $)throw"jQuery must be included before mc_shared_assets/social_sharing/product";$.fn.dataContext=function(){for(var e={},i=$.makeArray($(this).add($(this).parents())).reverse(),o=0;o<i.length;o++)$.extend(e,t(i[o]));return e},$.fn.socialShareProduct=function(t){return $(this).each(function(){var i=$(this),o=$.extend({},t,$(this).dataContext()),n=o.services;$.isArray(n)||(n=n.split(",")),i.append(e.create(n,o).$el)})},$(function(){$(".mc-shared-assets-social-sharing-product").socialShareProduct()})}),window.utils=window.utils||{},utils.PageViewHelper=function(){var e=this;this.setupListeners=function(){_e.on("router:pageView",e.pageViewEventDidFire)},this.pageViewEventDidFire=function(e){utils.sharedAssetsHelper.pageViewEventDidFire(e),utils.optimizelyHelper.pageViewEventDidFire()}},utils.pageViewHelper=new utils.PageViewHelper,utils.pageViewHelper.setupListeners(),window.utils=window.utils||{},utils.SharedAssetsHelper=function(){this.pageViewEventDidFire=function(e){e&&mc_shared_assets.analytics.api.pushContext(e),mc_shared_assets.analytics.api.trackEvent("pageView")}},utils.sharedAssetsHelper=new utils.SharedAssetsHelper,window.utils=window.utils||{},utils.OptimizelyHelper=function(){this.pageViewEventDidFire=function(){void 0!==window.optimizely&&window.optimizely.push(["activate"])}},utils.optimizelyHelper=new utils.OptimizelyHelper,!function(e,t,i){!function(){"use strict";var e={VERSION:"0.2.0-pre"},t=window.Caliper||{};if(t.loaded===!0){var i;return e.VERSION===t.VERSION?(i="Already loaded caliper.core  v"+e.VERSION,t.config&&t.config.debug===!0&&("function"==typeof t.warn?t.warn(i):window.console&&"function"==typeof window.console.warn?window.console.warn("[Caliper] "+i):window.console&&"function"==typeof window.console.log&&window.console.log("[Caliper] **WARNNING** "+i))):(i="Failed to load caliper.core  v"+e.VERSION+": "+"another version of caliper.core (v"+t.VERSION+") was already loaded","function"==typeof t.error?t.error(i):window.console&&"function"==typeof window.console.error?window.console.error("[Caliper] "+i):window.console&&"function"==typeof window.console.log&&window.console.log("[Caliper] **ERROR** "+i)),void 0}e.config={apiKey:null,beaconURL:"//b.caliper.io/_.gif",debug:!1,enabled:!0};for(var o in t.config)t.config.hasOwnProperty(o)&&(e.config[o]=t.config[o]);var n=function(){return!!(!window.attachEvent||window.addEventListener||window.navigator.userAgent.indexOf("MSIE 8.0")>=0)}();if(e.enabled=!(!n||!e.config.enabled),e.enabled===!1)return e.debug&&window.console&&"function"==typeof window.console.log&&window.console.log("[Caliper] Caliper is disabled"),window.Caliper=e,void 0;if(Date.now||(Date.now=function(){return(new Date).valueOf()}),e.__empty__=function(){},e.log=window.console&&"function"==typeof window.console.log?function(t){e.config.debug===!0&&window.console.log("[Caliper] "+t)}:e.__empty__,e.warn=window.console&&"function"==typeof window.console.warn?function(t){e.config.debug===!0&&window.console.warn("[Caliper] "+t)}:window.console&&"function"==typeof window.console.log?function(t){e.config.debug===!0&&window.console.log("[Caliper] **WARNNING** "+t)}:e.__empty__,e.error=window.console&&"function"==typeof window.console.error?function(e){window.console.error("[Caliper] "+e)}:window.console&&"function"==typeof window.console.log?function(e){window.console.log("[Caliper] **ERROR** "+e)}:e.__empty__,e.slice=function(e){return Array.prototype.slice.call(e)},e.setImmediate="function"==typeof window.setImmediate?function(){return window.setImmediate.apply(window,arguments)
}:function(e){var t=[].slice.call(arguments,1);return window.setTimeout(function(){e.apply(null,t)},0)},e.randomStr=function(e){var t=e.length;return function(i){for(var o=[],n=0;i>n;n++)o.push(e[Math.floor(Math.random()*t)]);return o.join("")}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"),e.__super__=function(){throw new Error("Cannot call Caliper.__super__ outside of a wrapped function")},e.wrap=function(t,i){return function(){var o=e.__super__,n=this,a=e.slice(arguments);try{return e.__super__="function"==typeof t?function(){return this===e?0===arguments.length?t.apply(n,a):t.apply(n,arguments):t.apply(this,arguments)}:e.__empty__,i.apply(this,arguments)}finally{e.__super__=o}}},e.aliasMethodChain=function(e,t,i,o){var n=e[t];if("function"==typeof n){var a="__"+t+"_without_"+i+"__",s="__"+t+"_with_"+i+"__";e[a]=n,e[s]=e[t]=o}return e},e.nameFor=function(e){return"string"==typeof e||e instanceof String?e:e&&e.constructor?e.__name__||e.constructor.__name__:void 0},e.log("Initializing caliper.core v"+e.VERSION+"..."),!e.config.apiKey||!e.config.apiKey.length)return e.error("Failed to load caliper.core: did you forget to set your Caliper API key?"),void 0;e.sessionID=e.randomStr(16),e.log("Generated session ID "+e.sessionID),e.visitorID=e.config.visitor||function(){var t,i=function(){for(var e="_cpv=",t=document.cookie.split(";"),i=0;i<t.length;i++){var o=t[i].replace(/^\s+|\s+$/g,""),n=o.indexOf(e);if(0===n)return o.substring(5,o.length)}return void 0},o=function(e){var t=new Date(Date.now()+631152e5);return document.cookie="_cpv="+e+"; expires="+t.toGMTString()+"; path=/",e};return t=i(),t?e.log("Using existing visitor ID "+t):(t=e.randomStr(16),e.log("Generated visitor ID "+t)),o(t)}();var a=0,s=function(e){"string"==typeof e&&(e=[e]);for(var t=[],i=0;i<e.length;i++)t.push(encodeURIComponent(e[i]).replace(/[-_~%]/g,function(e){switch(e){case"-":return"~2D";case"_":return"~5F";case"~":return"~7E";case"%":return"~"}}));return t.join("-")},r=function(e){if("string"==typeof e)return s(e);for(var t=[],i=0;i<e.length;i++)t.push(s(e[i]));return t.join("_")},l=function(e){for(var t in e)return!1;return!0};e.send=function(t,i){if(!e.config.apiKey||!e.config.apiKey.length)return e.error("Attempted to call send without an API key set, payload dropped"),void 0;if(t&&t.length>0||i&&!l(i)){var o={},n=[];for(var s in e.adapters)e.adapters.hasOwnProperty(s)&&n.push(s+"-"+e.adapters[s].VERSION);o.k=e.config.apiKey,o.c=n.join("_"),o.s=e.sessionID,e.config.visitor?o.e=encodeURIComponent(e.config.visitor):o.v=encodeURIComponent(e.visitorID);var c=[];for(var d in o)o.hasOwnProperty(d)&&c.push(d+"="+o[d]);for(d in i)i.hasOwnProperty(d)&&c.push(d+"="+encodeURIComponent(i[d]));var u=a++,h=e.config.beaconURL+"?"+c.join("&");t&&(h=h+"&p="+r(t)),e.log("Sending request "+u),h.length>2e3&&e.log("Request "+u+": URL is "+h.length+" characters long, this might cause errors in some browsers!");var g=function(){e.log("Completed request "+u)},p=function(){e.log("Failed request "+u+", giving up")},b=function(t,i,o){return function(){e.log("Failed request "+u+", retrying in "+t+" seconds"),window.setTimeout(function(){e.log("Retrying request "+u),o>0?e.dispatchRequest(h,g,b(t*i,i,o-1)):e.dispatchRequest(h,g,p)},1e3*t)}};e.dispatchRequest(h,g,b(30,2,2))}},e.dispatchRequest=function(e,t,i){var o=new Image;"function"==typeof t&&(o.onload=t),"function"==typeof i&&(o.onerror=i),o.src=e},e.adapters={core:e},e.loaded=!0,window.Caliper=e,e.log("Sucessfully loaded caliper.core v"+e.VERSION)}(),function(e,t,i,o){"use strict";var n={VERSION:"0.4.1"};if(void 0===e||e.loaded!==!0)e.enabled!==!1&&(window.console&&"function"==typeof window.console.error?window.console.error("[Caliper] Failed to load caliper.backbone: caliper.core could not be found"):window.console&&"function"==typeof window.console.log&&window.console.error("[Caliper] **ERROR** Failed to load caliper.backbone: caliper.core could not be found"));else if(e.adapters&&e.adapters.Backbone)e.adapters.Backbone.VERSION===n.VERSION?e.warn("Already loaded caliper.backbone v"+n.VERSION):e.error("Failed to load caliper.backbone v"+n.VERSION+": "+"another version of caliper.backbone (v"+e.adapters.Backbone.VERSION+") was already loaded");else if(void 0===t)e.error("Failed to load caliper.backbone: Backbone could not be found");else if(void 0===i)e.error("Failed to load caliper.backbone: Underscore could not be found");else{e.log("Initializing caiper.backbone v"+n.VERSION),void 0===e.config.enableAjaxFilter&&e.config.disableAjaxFilter===!1&&(e.config.enableAjaxFilter=!0),e.config.enableAjaxFilter=e.config.enableAjaxFilter||!1,e.config.minDuration=e.config.minDuration||50;var a=i.result||function(e,t){if(!e)return null;var o=e[t];return i.isFunction(o)?o.call(e):o},s=e.wrap(e.aliasMethodChain,function(t,o,n,a){var s=t[o];if("function"!=typeof s)return t;var r=e.wrap(s,a);return r="function"==typeof s.extend?s.extend({constructor:r}):i.extend(r,s),e.__super__(t,o,n,r)});e.aliasMethodChain(e,"aliasMethodChain","underscore",s),e.aliasMethodChain(e,"nameFor","backbone",function(i){var o=e.__super__();return!o&&i instanceof t.View&&(o="UnnamedView",i.id?o=o+"<#"+a(i,"id")+">":i.className&&(o=o+"<."+a(i,"className")+">"),i.__name__=o),o});var r=function(e,t){this.method=e,this.url=t,this.startTime=Date.now(),this.pending=!0};r.prototype.stop=function(){this.pending&&(this.stopTime=Date.now(),this.pending=!1)},r.prototype.serialize=function(e){return this.pending===!1?(e=e||0,["a",this.method,this.url,this.startTime-e,this.stopTime-this.startTime]):void 0};var l=function(e){this.viewName=e,this.startTime=Date.now(),this.pending=!0};l.prototype.stop=r.prototype.stop,l.prototype.serialize=function(e){return this.pending===!1?(e=e||0,["r",this.viewName,this.startTime-e,this.stopTime-this.startTime]):void 0};var c=[],d=function(){return c[c.length-1]},u=function(e,t,i){this.klass=e,this.method=t,this.pattern=i,this.startTime=Date.now(),this.events=[],this.finalized=!1,c.push(this)};u.prototype.finalize=function(){if(this.finalized!==!0){var i;for(i=1;i<=c.length;i++)c[c.length-i]===this&&c.splice(c.length-i,1);for(i=0;i<this.events.length;i++)if(this.events[i].pending)return;if(this.stopTime=Date.now(),this.finalized=!0,this.duration=this.stopTime-this.startTime,this.duration<(e.config.minDuration||1))return e.log("Dropped: "+this.klass+"."+this.method+" ("+this.pattern+"), took "+this.duration+"ms. (minDuration is "+e.config.minDuration+"ms)"),void 0;if(e.config.enableAjaxFilter===!0){var o=!1;for(i=0;i<this.events.length;i++)if(this.events[i]instanceof r){o=!0;break}if(!o)return e.log("Dropped: "+this.klass+"."+this.method+" ("+this.pattern+"), took "+this.duration+"ms. (enableAjaxFilter is true)"),void 0}e.log("Sending: "+this.klass+"."+this.method+" ("+this.pattern+"), took "+this.duration+"ms.");try{this.url=t.history.getFragment()}catch(n){this.url=window.location.hash.length?window.location.hash.substr(1):window.location.pathname}var a={bs:this.startTime,bd:this.duration,bu:this.url};this.klass&&this.klass.length>0&&(a.bc=this.klass),this.method&&this.method.length>0&&(a.bm=this.method),this.pattern&&this.pattern.length>0&&(a.bp=this.pattern);var s=[];for(i=0;i<this.events.length;i++)s.push(this.events[i].serialize(this.startTime));e.send(s,a)}},void 0!==t.Router&&e.aliasMethodChain(t,"Router","instrumentation",function(){return e.aliasMethodChain(this,"route","instrumentation",function(){var t=e.slice(arguments),i=String(t[0]),o=t[1],n=t[2];return"/"!==i[0]&&"!"!==i[0]&&(i="/"+i),"function"==typeof o?(n=o,o=void 0):void 0===n&&(n=this[o]),n=e.wrap(n,function(){var t=d();return t?(t.klass=e.nameFor(this),t.method=o,t.pattern=i):t=new u(e.nameFor(this),o,i),e.setImmediate(function(){t.finalize()}),e.__super__()}),e.__super__.call(this,t[0],o||"",n)}),e.__super__()}),void 0!==t.View&&e.aliasMethodChain(t,"View","instrumentation",function(){e.aliasMethodChain(this,"initialize","instrumentation",function(){var t;return d()||(t=new u(e.nameFor(this),"initialize"),e.setImmediate(function(){t.finalize()})),e.__super__()}),e.aliasMethodChain(this,"render","instrumentation",function(){var t,i=d();i&&(t=new l(e.nameFor(this)),i.events.push(t));var o=e.__super__();return t&&t.stop(),o});var t=function(t,i){return e.wrap(t,function(){if(!d()){var t=new u(e.nameFor(this),i);e.setImmediate(function(){t.finalize()})}return e.__super__()})};return e.aliasMethodChain(this,"delegateEvents","instrumentation",function(){var o,n,s=e.slice(arguments),r=i.clone(s[0]||a(this,"events"));for(var l in r)if(r.hasOwnProperty(l)){if(n=r[l],i.isFunction(n)?o="UnnamedAction":(o=n,n=this[n]),!n)continue;r[l]=t(n,o)}return e.__super__(r)}),e.__super__()}),e.aliasMethodChain(o,"ajax","instrumentation",function(){var t=d();if(t){var i=arguments[1]||arguments[0],o=i.type||"GET",n=i.url||arguments[0];"string"==typeof i&&(i={});var a=new r(o,n);return t.events.push(a),i.success=e.wrap(i.success,function(){return d()!==t&&c.push(t),a.stop(),e.__super__()}),i.error=e.wrap(i.error,function(){return d()!==t&&c.push(t),a.stop(),e.__super__()}),i.complete=e.wrap(i.complete,function(){return e.setImmediate(function(){t.finalize()}),e.__super__()}),i.url=n,e.__super__(i)}return e.__super__()}),t.history=t.history||new t.History,e.adapters.Backbone=n,e.log("Sucessfully loaded caliper.backbone v"+n.VERSION)}}(window.Caliper,e,t,i)}(window.Backbone,window._,window.jQuery||window.Zepto);